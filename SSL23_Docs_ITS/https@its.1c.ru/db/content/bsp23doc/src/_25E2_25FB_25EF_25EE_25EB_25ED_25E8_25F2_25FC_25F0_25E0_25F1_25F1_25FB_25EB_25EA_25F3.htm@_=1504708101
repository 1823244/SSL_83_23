<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>&#1042;&#1099;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100;&#1056;&#1072;&#1089;&#1089;&#1099;&#1083;&#1082;&#1091;</title>
		<LINK REL="stylesheet" href="style.css@_=1504708101">
		<SCRIPT src="script.js@_=1504708101" TYPE="text/javascript"></script>
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="_25E2_25FB_25EF_25EE_25EB_25ED_25E8_25F2_25FC_25F0_25E0_25F1_25F1_25FB_25EB_25EA_25F3.htm" rel="canonical">
<link href="../../../../static/its.content.css@_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="../../../../static/its.content.js@_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="../../../../static/html5shiv.js@_=1500896273"></script><![endif]-->

</head>
	<body class="bspdoc">
<a name="_рассылкаотчетоввыполнитьрассылку"></a><h1>ВыполнитьРассылку</h1>

<pre> Формирует отчеты и отправляет согласно настройкам транспорта (Папка, FILE, EMAIL, FTP);
   Позволяет выполнить рассылку не создавая элемент справочника "Рассылки отчетов".</pre>
<p class="Paragraph0c"><span class="Bold">Синтаксис</span></p>
<pre> Функция ВыполнитьРассылку(ТаблицаОтчетов, ПараметрыДоставки, Рассылка, ПараметрыЖурнала = Неопределено) Экспорт</pre>
<p class="Paragraph0c"><span class="Bold">Параметры</span></p>
<pre>   ТаблицаОтчетов - ТаблицаЗначений - Набор выгружаемых отчетов. Колонки:
       * Отчет - СправочникСсылка.ВариантыОтчетов, СправочникСсылка.ДополнительныеОтчетыИОбработки -
           Отчет, который необходимо сформировать.
       * ОтправлятьЕслиПустой - Булево - Флаг отправки отчета даже если он пустой.
       * Настройки - Настройки, с которыми должен сформироваться отчет.
           Дополнительно используется для определения принадлежности отчета к СКД.
           - ПользовательскиеНастройкиКомпоновкиДанных - Табличный документ сформируется механизмами СКД.
           - Структура - Табличный документ сформируется при помощи метода "Сформировать()".
               *** Ключ     - Строка       - Имя реквизита объекта отчета.
               *** Значение - Произвольный - Значение реквизита объекта отчета.
           - Неопределено - Настройки по умолчанию. Для определения принадлежности к СКД
               будет использован реквизит объекта "СхемаКомпоновкиДанных".
       * Форматы - Массив из ПеречислениеСсылка.ФорматыСохраненияОтчетов -
            Форматы, в которых необходимо сохранить и отправить отчет.
   ПараметрыДоставки - Структура - Настройки транспорта (способа доставки) отчетов.
     Набор реквизитов может отличаться для разных способов доставки:
     Обязательные реквизиты:
       * Автор - СправочникСсылка.Пользователи - Автор рассылки.
       * ИспользоватьПапку            - Булево - Доставлять отчеты в папку подсистемы "Работа с файлами".
       * ИспользоватьСетевойКаталог   - Булево - Доставлять отчеты в папку файловой системы.
       * ИспользоватьFTPРесурс        - Булево - Доставлять отчеты на FTP.
       * ИспользоватьЭлектроннуюПочту - Булево - Доставлять отчеты по электронной почте.
     Обязательные реквизиты когда { ИспользоватьПапку = Истина }:
       * Папка (СправочникСсылка.ПапкиФайлов) Папка подсистемы "Работа с файлами".
     Обязательные реквизиты когда { ИспользоватьСетевойКаталог = Истина }:
       * СетевойКаталогWindows - Строка - Каталог файловой системы (локальный на сервере или сетевой).
       * СетевойКаталогLinux   - Строка - Каталог файловой системы (локальный на сервере или сетевой).
     Обязательные реквизиты когда { ИспользоватьFTPРесурс = Истина }:
       * Сервер              - Строка - Имя FTP сервера.
       * Порт                - Число - Порт FTP сервера.
       * Логин               - Строка - Имя пользователя FTP сервера.
       * Пароль              - Строка - Пароль пользователя FTP сервера.
       * Каталог             - Строка - Путь к каталогу на FTP сервере.
       * ПассивноеСоединение - Булево - Использовать пассивное соединение.
     Обязательные реквизиты когда { ИспользоватьЭлектроннуюПочту = Истина }:
       * УчетнаяЗапись - СправочникСсылка.УчетныеЗаписиЭлектроннойПочты -
           Учетная запись для отправки почтового сообщения.
       * Получатели - Соответствие - Набор получателей и их e-mail адресов.
           ** Ключ - СправочникСсылка - Получатель.
           ** Значение - Строка - Набор e-mail адресов получателя в строке с разделителями.
     Необязательные реквизиты:
       * Архивировать - Булево - Архивировать все файлы сформированных отчетов в один архив.
                                 Архивация может потребоваться, например, при рассылке графиков в формате html.
       * ИмяАрхива    - Строка - Имя архива.
       * ПарольАрхива - Строка - Пароль архива.
     Необязательные реквизиты когда { ИспользоватьЭлектроннуюПочту = Истина }:
       * Персонализирована - Булево - Рассылка персонализирована получателями.
           Значение по умолчанию Ложь.
           Если установить значение Истина, то каждый получатель получит отчет с отбором по нему.
           Для этого в отчетах следует установить отбор "[Получатель]" по реквизиту, совпадающем с типом получателя.
           Применимо только только при доставке по почте,
           поэтому когда устанавливается в Истина, то другие способы доставки отключаются:
           { ИспользоватьПапку = Ложь }
           { ИспользоватьСетевойКаталог = Ложь }
           { ИспользоватьFTPРесурс = Ложь }
           И соответствующая им возможность уведомления:
           { ТолькоУведомить = Ложь }
       * ТолькоУведомить - Булево, Ложь - Отправлять только уведомления (не присоединять сформированные отчеты).
       * СкрытыеКопии    - Булево, Ложь - Если "Истина", то при отправке вместо "Кому" заполняется "СлепыеКопии".
       * ШаблонТемы      - Строка -       Тема письма.
       * ШаблонТекста    - Строка -       Тело письма.
       * ПараметрыПисьма - Структура -    Параметры сообщения,
           которые будут переданы подсистеме "РаботаСПочтовымиСообщениями" напрямую.
           Их обработку можно увидеть в модуле "РаботаСПочтовымиСообщениямиСлужебный", процедура "ОтправитьСообщение".
           Подсистемой "РассылкаОтчетов" могут использоваться:
           ** ТипТекста - ТипТекстаПочтовогоСообщения, Строка, ПеречислениеСсылка.ТипыТекстовЭлектронныхПисем -
               Тип текста письма.
           ** Вложения - Соответствие - Картинки письма.
               *** Ключ - Строка - Наименование.
               *** Значение - Данные картинки.
                   - Строка - Адрес во временном хранилище, по которому размещена картинка.
                   - ДвоичныеДанные - Двоичные данные картинки.
                   - Картинка - Данные картинки.
           ** АдресОтвета - Строка - E-mail адрес ответа.
   Рассылка - Произвольный - Объект-инициатор.
       Его представление используется в шаблонах темы и сообщения и для отображения ошибок.
   ПараметрыЖурнала - Структура - Необязательный. Параметры записи в журнал регистрации.
       * ИмяСобытия - Строка           - Имя события (или группы событий).
       * Метаданные - ОбъектМетаданных - Метаданные для привязки события журнала регистрации.
       * Данные     - Произвольный     - Данные для привязки события журнала регистрации.</pre>
<p class="Paragraph0c"><span class="Bold">Возвращаемое значение</span></p>
<pre>   Истина - Рассылка выполнена.
   Ложь   - Рассылка не выполнена.</pre>
<p class="Paragraph0c"><span class="Bold">Пример вызова</span></p>
<pre> Результат = РассылкаОтчетов.ВыполнитьРассылку(ТаблицаОтчетов, ПараметрыДоставки, Рассылка, ПараметрыЖурнала)</pre>
<p class="Paragraph0c"><span class="Bold">Доступность</span></p>
<pre> Сервер, Толстый клиент, Внешнее соединение</pre>
	</body>
</html>