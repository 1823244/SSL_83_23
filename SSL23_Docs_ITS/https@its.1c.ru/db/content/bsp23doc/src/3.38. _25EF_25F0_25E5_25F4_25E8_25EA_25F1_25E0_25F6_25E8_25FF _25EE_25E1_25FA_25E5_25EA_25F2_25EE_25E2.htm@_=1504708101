<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>3.38. &#1055;&#1088;&#1077;&#1092;&#1080;&#1082;&#1089;&#1072;&#1094;&#1080;&#1103; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;</title>
		<LINK REL="stylesheet" href="style.css@_=1504708101">
		<SCRIPT src="script.js@_=1504708101" TYPE="text/javascript"></script>
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="3.38. _25EF_25F0_25E5_25F4_25E8_25EA_25F1_25E0_25F6_25E8_25FF _25EE_25E1_25FA_25E5_25EA_25F2_25EE_25E2.htm" rel="canonical">
<link href="../../../../static/its.content.css@_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="../../../../static/its.content.js@_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="../../../../static/html5shiv.js@_=1500896273"></script><![endif]-->

</head>
	<body class="bspdoc">
<h1>3.38. Префиксация объектов</h1>

<p class="Paragraph0c">Подсистема «Префиксация объектов» предназначена для
автоматического назначения префиксов объектам с учетом настроек программы.
Префиксация объектов ведется в разрезах информационных баз и элементов
справочника <span class="Interface">Организации</span>.</p>

<a name="issogl1_настройка"><h2>Настройка</h2></a>

<p class="Paragraph0c">Настройка подсистемы «Префиксация объектов» различается в
зависимости от внедрения совместно с подсистемой «Обмен данными» и наличия в
конфигурации справочника <span class="Interface">Организации</span>. Настройка
подсистемы сводится к созданию подписок на события для задания номера (или
кода) объекта и подписки для очистки номера объекта.</p>

<a name="issogl2_создание_подписок_для_установки_префикса_в_номере_коде_объекта"><h3>Создание подписок для установки префикса в номере (коде) объекта</h3></a>

<p class="Paragraph0c">Следует создать необходимое количество подписок на события
для задания номера или кода объекта при его записи, если номер или код не
заполнены. Значения свойств подписок задать согласно таблице.</p>

<p class="Objectname">Таблица 3.80.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Имя свойства</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Описание</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Имя</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Имя следует задавать для удобства визуального
  восприятия подписки и с учетом ограничений, налагаемых на имена объектов
  метаданных, например <span class="Interface">УстановитьПрефиксИнформационнойБазыИОрганизацииНомеруДокумента</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Источник</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Источниками событий подписки могут быть только объекты
  типов: <span class="Interface">Документы</span>, <span class="Interface">Справочники</span>,
  <span class="Interface">Планы видов характеристик</span>, <span class="Interface">Бизнес-процессы</span>. В качестве источников для одной
  подписки могут быть использованы объекты только одного типа</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Событие</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ПриУстановкеНовогоКода</span>
  или <span class="Interface">ПриУстановкеНовогоНомера</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Обработчик</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">В качестве процедур – обработчиков подписок следует
  выбирать экспортные процедуры общего модуля <span class="Interface">ПрефиксацияОбъектовСобытия</span></p>
  </td>
 </tr>
</table>

<p class="Warningword">Важно!</p>

<p class="Notes">Для объектов <span class="Interface">Задача</span> префикс номеров
устанавливается подсистемой «Бизнес-процессы и задачи». Использование
подсистемы префиксации для объектов <span class="Interface">Задача</span> будет
вызывать ошибки в работе конфигурации.</p>

<p class="Paragraph0c">В общем модуле <span class="Interface">ПрефиксацияОбъектовСобытия</span>
предусмотрено три процедуры-обработчика подписок, использование которых
различается в зависимости от наличия в конфигурации справочника <span class="Interface">Организации</span> и подсистемы «Обмен данными»:</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">УстановитьПрефиксОрганизации</span>
– следует использовать в том случае, если требуется выполнять префиксацию
объектов только в разрезе организаций.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">УстановитьПрефиксИнформационнойБазы</span>
– следует использовать в том случае, если используется подсистема «Обмен
данными», а префиксацию объектов в разрезе организаций выполнять не требуется.
К таким типам объектов в основном относятся справочники и планы видов характеристик.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">УстановитьПрефиксИнформационнойБазыИОрганизации</span>
– следует использовать в том случае, если требуется выполнять префиксацию
объектов в разрезе информационных баз и организаций одновременно. К таким типам
объектов в основном относятся документы.</p>

<p class="Paragraph0c">Разработчик может выбирать процедуры-обработчики в
зависимости от требуемой бизнес-логики.</p>

<p class="Paragraph0c">Если в конфигурации имеется справочник <span class="Interface">Организации</span>, то для возможности префиксации объектов в
разрезе организаций следует создать следующие объекты метаданных:</p>

<p class="MsoListBullet">&#9679; 
реквизит <span class="Interface">Префикс</span> (<span class="Interface">Строка</span>, 2) у справочника <span class="Interface">Организации</span>;</p>

<p class="MsoListBullet">&#9679; 
параметр функциональной опции <span class="Interface">Организация</span> с использованием справочника <span class="Interface">Организации</span>;</p>

<p class="MsoListBullet">&#9679; 
функциональная опция <span class="Interface">ПрефиксыОрганизаций
</span>с хранением в реквизите справочника <span class="Interface">Организации</span>.</p>

<a name="issogl2_создание_подписок_для_переназначения_номера_кода_объекта"><h3>Создание подписок для переназначения номера (кода) объекта</h3></a>

<p class="Paragraph0c">Следует создать необходимое количество подписок на события
для переназначения номера (кода) объекта при изменении даты или значения
реквизита <span class="Interface">Организация</span> в шапке объекта. После
очистки объекту будет назначен новый код или номер.</p>

<p class="Paragraph0c">Значения свойств подписок надо задать согласно таблице:</p>

<p class="Objectname">Таблица 3.81.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Имя свойства</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Описание</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Имя</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Имя следует задавать для удобства визуального
  восприятия подписки и с учетом ограничений, налагаемых на имена объектов
  метаданных, например, <span class="Interface">ПроверитьНомерДокументаПоДатеИОрганизации</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Источник</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Источниками событий подписки могут быть только объекты
  типов: <span class="Interface">Документы</span>, <span class="Interface">Справочники</span>,
  <span class="Interface">Планы видов характеристик</span>, <span class="Interface">Бизнес-процессы</span>. В качестве источников для одной
  подписки могут быть использованы объекты только одного типа</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Событие</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ПередЗаписью</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Обработчик</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">В качестве процедур – обработчиков подписок следует
  выбирать экспортные процедуры общего модуля <span class="Interface">ПрефиксацияОбъектовСобытия</span></p>
  </td>
 </tr>
</table>

<p class="Paragraph0c">В общем модуле <span class="Interface">ПрефиксацияОбъектовСобытия</span>
предусмотрено пять процедур – обработчиков подписок, каждую из которых
необходимо использовать исходя из типа объектов – источников подписок и наличия
реквизита <span class="Interface">Организация</span> в шапке этих объектов:</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ПроверитьКодСправочникаПоОрганизации</span>
– следует использовать для справочников, у которых нумерация кодов выполняется
в разрезе справочника <span class="Interface">Организации</span>.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ПроверитьНомерБизнесПроцессаПоДате</span>
– следует использовать для бизнес-процессов, у которых нумерация выполняется
только в пределах заданной периодичности.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ПроверитьНомерБизнесПроцессаПоДатеИОрганизации</span>
– следует использовать для бизнес-процессов, у которых нумерация выполняется в
пределах заданной периодичности и в разрезе справочника <span class="Interface">Организации</span>.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ПроверитьНомерДокументаПоДате</span>
– следует использовать для документов, у которых нумерация выполняется только в
пределах заданной периодичности.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ПроверитьНомерДокументаПоДатеИОрганизации</span>
– следует использовать для документов, у которых нумерация выполняется в
пределах заданной периодичности и в разрезе справочника <span class="Interface">Организации</span>.</p>

<p class="Paragraph0c">В большинстве случаев в конфигурации требуется создание
только трех подписок: двух для назначения префиксов справочникам и документам и
одной для очистки номеров документов. Пример для создания таких подписок
представлен в таблице.</p>

<p class="Objectname">Таблица 3.82.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Имя подписки</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Обработчик</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">УстановитьПрефиксИнформационнойБазыКодуСправочника</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ПрефиксацияОбъектовСобытия.УстановитьПрефиксИнформационнойБазы</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">УстановитьПрефиксИнформационнойБазыИОрганизацииНомеруДокумента</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ПрефиксацияОбъектовСобытия.УстановитьПрефиксИнформационнойБазыИОрганизации</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ПроверитьНомерДокументаПоДатеИОрганизации</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ПрефиксацияОбъектовСобытия.ПроверитьНомерДокументаПоДатеИОрганизации</span></p>
  </td>
 </tr>
</table>

<p class="Paragraph0c">Если объекту требуется устанавливать префикс организации,
то в составе реквизитов шапки объекта должен присутствовать реквизит <span class="Interface">Организация</span>. Обязательные значения свойств реквизита
указаны в таблице.</p>

<p class="Objectname">Таблица 3.83.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Свойство</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Значение</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Имя</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Организация</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Тип</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">СправочникСсылка.Организации</span></p>
  </td>
 </tr>
</table>

<a name="issogl2_настройка_прав_доступа_пользователей"><h3>Настройка прав доступа пользователей</h3></a>

<p class="Paragraph0c">Настройка прав доступа пользователей к данным подсистемы
«Префиксация объектов» не требуется.</p>

<a name="issogl1_использование_при_разработке_конфигурации"><h2>Использование при разработке конфигурации</h2></a>

<a name="issogl2_формат_префиксов_и_логика_их_установки_объектам"><h3>Формат префиксов и логика их установки объектам</h3></a>

<p class="Paragraph0c">Назначение префикса номеру или коду объекта происходит в
момент первой записи объекта, если код или номер не были назначены вручную.
Назначение префикса также происходит, если номер или код объекта были очищены
перед его записью.</p>

<p class="Paragraph0c">Префикс имеет фиксированную длину 3 или 5 символов. В
префиксе нельзя использовать символ «-» (дефис); он используется для разделения
префикса c номером и добавляется автоматически. Соответственно префикс
формируется по одному из двух шаблонов: «<span class="Interface">ОРИБ-</span>»
или «<span class="Interface">ИБ-</span>», где ОР – 2 символа префикса справочника
<span class="Interface">Организации</span>; ИБ – 2 символа префикса
информационной базы; «-» (дефис) – разделитель префикса. </p>

<p class="Paragraph0c">Для конфигураций, в которых используется подсистема
префиксации, длину номеров документов и кодов справочников рекомендуется
устанавливать не менее 11 символов.</p>

<p class="Paragraph0c">Если префикс информационной базы или префикс организации
не указан, то считается, что такой префикс отсутствует, он заменяется двумя
нулями – «00».</p>

<p class="Paragraph0c">Для предопределенных элементов ссылочных типов данных,
создаваемых в режиме конфигуратора, рекомендуется назначать префикс кода
элемента в момент его создания. Как правило, для таких элементов требуется
назначить только префикс информационной базы. Например, для преопределенного
элемента справочника в конфигураторе может быть назначен такой код:
«УТ-00000001». Если этого не выполнить, то, если настроен обмен данными между
разными конфигурациями, для справочников с предопределенными элементами может
быть нарушена уникальность кодов этих элементов.</p>

<a name="issogl2_программный_интерфейс"><h3>Программный интерфейс</h3></a>

<p class="Paragraph0c">Программный интерфейс подсистемы доступен через экспортные
процедуры-обработчики общих модулей <span class="Interface">ПрефиксацияОбъектовСобытия</span>
и <span class="Interface">ПрефиксацияОбъектовКлиентСерверПереопределяемый</span>.</p>

<p class="Paragraph0c">Для взаимодействия с подсистемой печати предусмотрена
экспортная функция общего модуля. Функция позволяет сформировать номер документа
для вывода в печатной форме: <span class="Interface">ПрефиксацияОбъектовСобытия.ПолучитьНомерНаПечать</span>.</p>

<p class="Paragraph0c">Функция отбрасывает префикс организации, отбрасывает
префикс информационной базы (опционально), отбрасывает пользовательские
префиксы (опционально), удаляет лидирующие нули в номере объекта.</p>

<p class="Warningword">Пример</p>

<p class="Notes">Документ имеет номер ФР0Г-А001234. После отбрасывания префикса
организации и незначащих нулей номера для печати получим значение: Г-А1234.</p>

<p class="Paragraph0c">В подсистеме предусмотрен обработчик события «При
получении номера на печать». Обработчик срабатывает перед стандартной
обработкой и предназначен для формирования номера объекта нестандартным
способом. Например, когда формат номера документа отличается от стандартного.
Для задания кода обработчика используется процедура <span class="Interface">ПрефиксацияОбъектовКлиентСерверПереопределяемый.ПриПолученииНомераНаПечать</span>.</p>

<a name="issogl2_дополнительные_возможности_по_настройке_формата_префиксов"><h3>Дополнительные возможности по настройке формата префиксов</h3></a>

<p class="Paragraph0c">Подсистема предоставляет возможность добавлять к префиксу
произвольную последовательность символов, например, дополнительный префикс «А»
для документов <span class="Interface">Счет-фактура на аванс</span>. Для этого в
модуле объекта, в обработчике <span class="Interface">ПриУстановкеНовогоНомера</span>
следует задать значение переменной <span class="Interface">Префикс</span>.</p>

<p class="Paragraph0c">Пример номера документа с установленным префиксом:
ФР0Г-А001234 – документ № 1234 с пользовательским префиксом «А», заведенный на
организацию «ФР», созданный в информационной базе «Г».</p>

<a name="issogl2_переопределение_имени_реквизита_который_содержит_ссылку_на_организацию"><h3>Переопределение имени реквизита, который содержит ссылку на организацию</h3></a>

<p class="Paragraph0c">В подсистеме предусмотрена стандартная обработка установки
префикса организации. Стандартная обработка подразумевает, что значение ссылки
на организации выбирается из реквизита шапки объекта с именем <span class="Interface">Организация</span>. Однако в некоторых объектах реквизит может
именоваться иначе (например, <span class="Interface">Владелец</span> или <span class="Interface">ГоловнаяОрганизация</span>). Если ссылка на организацию в
объекте располагается в реквизите с именем, отличным от стандартного имени <span class="Interface">Организация</span>, то необходимо воспользоваться обработчиком <span class="Interface">ПолучитьПрефиксообразующиеРеквизиты</span> в переопределяемом
модуле подсистемы <span class="Interface">ПрефиксацияОбъектовПереопределяемый</span>.</p>

<a name="issogl2_настройка_обмена_данными"><h3>Настройка обмена данными</h3></a>

<p class="Paragraph0c">Для настройки обмена данными никаких действий не
требуется, так как подсистема не предоставляет собственных данных.</p>
	</body>
</html>