<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>3.4. &#1041;&#1072;&#1079;&#1086;&#1074;&#1072;&#1103; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1086;&#1085;&#1072;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1100;</title>
		<LINK REL="stylesheet" href="style.css@_=1504708101">
		<SCRIPT src="script.js@_=1504708101" TYPE="text/javascript"></script>		<!--[if !IE]>--><SCRIPT src="zeroclipboard.js@_=1504708101" TYPE="text/javascript"></script><!--<![endif]-->
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="3.4. _25E1_25E0_25E7_25EE_25E2_25E0_25FF _25F4_25F3_25ED_25EA_25F6_25E8_25EE_25ED_25E0_25EB_25FC_25ED_25EE_25F1_25F2_25FC.htm" rel="canonical">
<link href="../../../../static/its.content.css@_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="../../../../static/its.content.js@_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="../../../../static/html5shiv.js@_=1500896273"></script><![endif]-->

</head>
	<body class="bspdoc">
<a name="_базовая_функциональность"></a><h1>3.4. Базовая функциональность</h1>

<p class="Paragraph0c">Подсистема «Базовая функциональность» содержит базовый
функционал, обязательный для всех прикладных решений, использующих библиотеку.
К базовому функционалу относятся процедуры и функции общего назначения, ряд
универсальных обработок, а также стандартные роли: <span class="Interface">ПолныеПрава</span>,
<span class="Interface">БазовыеПрава</span> и другие.</p>

<a name="issogl1_настройка"><h2>Настройка</h2></a>

<a name="issogl2_базовые_типы"><h3>Базовые типы</h3></a>

<p class="Paragraph0c">Если в конфигурации имеется справочник <span class="Interface">Организации</span>, то необходимо:</p>

<p class="MsoListBullet">&#9679; 
указать ссылку на него в свойстве <span class="Interface">Тип </span>определяемого типа <span class="Interface">Организация</span>;</p>

<p class="MsoListBullet">&#9679; 
реализовать в модуле менеджера справочника <span class="Interface">Организации</span> в области <span class="Interface">ПрограммныйИнтерфейс</span>
две экспортные функции:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Возвращает организацию по умолчанию.</span>
<span class="comment">// Если в ИБ есть только одна организация, которая не помечена на удаление и не является предопределенной,</span>
<span class="comment">// то будет возвращена ссылка на нее, иначе будет возвращена пустая ссылка.</span>
<span class="comment">//</span>
<span class="comment">// Возвращаемое значение:</span>
<span class="comment">//     СправочникСсылка.Организации - ссылка на организацию.</span>
<span class="comment">//</span>
<span class="keyword">Функция</span> ОрганизацияПоУмолчанию<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Экспорт</span>
<span class="keyword">КонецФункции</span>
<span class="comment">// Возвращает количество элементов справочника Организации.</span>
<span class="comment">// Не учитывает предопределенные и помеченные на удаление элементы.</span>
<span class="comment">//</span>
<span class="comment">// Возвращаемое значение:</span>
<span class="comment">//     Число - количество организаций.</span>
<span class="comment">//</span>
<span class="keyword">Функция</span> КоличествоОрганизаций<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Экспорт</span>
<span class="keyword">КонецФункции</span></pre>

<a name="issogl2_инициализация_параметров_сеанса"><h3>Инициализация параметров сеанса</h3></a>

<p class="Paragraph0c">Для инициализации параметров сеанса требуется вписать имя
параметра сеанса и путь к его обработчику в процедуру <span class="Interface">ОбработчикиИнициализацииПараметровСеанса</span>
общего модуля <span class="Interface">ОбщегоНазначенияПереопределяемый</span>.
При этом обработчик инициализации должен принимать два параметра:</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ИмяПараметра</span> –
строка – имя инициализируемого параметра;</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">УстановленныеПараметры</span>
– массив – имена параметров, которые были инициализированы.</p>

<a name="_настройка_исключений_поиска"></a><a name="issogl2_проверка_минимальной_версии_платформы"><h3>Проверка минимальной версии платформы</h3></a>

<p class="Paragraph0c">Для проверки того, что версия платформы подходит для
запуска конфигурации, необходимо вызвать функцию <span class="Interface">СтандартныеПодсистемыКлиент.ПроверитьВерсиюПлатформы</span>
в обработчике <span class="Interface">ПриНачалеРаботыСистемы</span> модуля
управляемого и обычного приложения. Пример реализации можно найти в модуле
управляемого и обычного приложения демонстрационной конфигурации.</p>

<a name="issogl2_подключить_формы_объектов_программы"><h3>Подключить формы объектов программы</h3></a>

<p class="Paragraph0c">Для подключения форм объектов программы, в которых
требуется выводить подключаемые команды, надо:</p>

<p class="MsoListBullet">&#9679; 
В процедуре <span class="Interface">ПриСозданииНаСервере</span>
(обработчик события формы) вставить вызов по шаблону:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"> <span class="comment">// СтандартныеПодсистемы.ПодключаемыеКоманды</span>
 ПодключаемыеКоманды<span class="operator">.</span>ПриСозданииНаСервере<span class="operator">(</span>ЭтотОбъект<span class="operator">,</span> <span class="operator">,</span> <span class="keyword">Истина</span><span class="operator">)</span><span class="operator">;</span>
 <span class="comment">// Конец СтандартныеПодсистемы.ПодключаемыеКоманды</span></pre>

<p class="MsoListBullet">&#9679; 
В модуле формы вставить процедуры (обработчики
команд):</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// СтандартныеПодсистемы.ПодключаемыеКоманды</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> Подключаемый_ВыполнитьКоманду<span class="operator">(</span>Команда<span class="operator">)</span>
 ПодключаемыеКомандыКлиент<span class="operator">.</span>ВыполнитьКоманду<span class="operator">(</span>ЭтотОбъект<span class="operator">,</span> Команда<span class="operator">,</span> <span class="operator">&lt;</span>ОбъектИлиТаблицаФормы<span class="operator">&gt;</span><span class="operator">,</span> <span class="keyword">Истина</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаСервере</span>
<span class="keyword">Процедура</span> Подключаемый_ВыполнитьКомандуНаСервере<span class="operator">(</span>Контекст<span class="operator">,</span> Результат<span class="operator">)</span>
 ПодключаемыеКоманды<span class="operator">.</span>ВыполнитьКоманду<span class="operator">(</span>ЭтотОбъект<span class="operator">,</span> Контекст<span class="operator">,</span> <span class="operator">&lt;</span>ОбъектИлиТаблицаФормы<span class="operator">&gt;</span><span class="operator">,</span> Результат<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> Подключаемый_ОбновитьКоманды<span class="operator">(</span><span class="operator">)</span>
 ПодключаемыеКомандыКлиентСервер<span class="operator">.</span>ОбновитьКоманды<span class="operator">(</span>ЭтотОбъект<span class="operator">,</span> <span class="operator">&lt;</span>ОбъектИлиТаблицаФормы<span class="operator">&gt;</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="comment">// Конец СтандартныеПодсистемы.ПодключаемыеКоманды</span></pre>

<p class="MsoListBullet">&#9679; 
Если форма является формой объекта, тогда:</p>

<p class="MsoListBullet2">&#9679; 
В параметре &lt;<span class="Interface">ОбъектИлиТаблицаФормы</span>&gt; следует
передавать реквизит формы типа <span class="Interface">ДанныеФормыСтруктура</span>.
Например:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"> ПодключаемыеКомандыКлиент<span class="operator">.</span>ВыполнитьКоманду<span class="operator">(</span>ЭтотОбъект<span class="operator">,</span> Команда<span class="operator">,</span> Объект<span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoListBullet2">&#9679; 
В обработчике <span class="Interface">ПриЧтенииНаСервере</span> формы
следует вставить вызов по шаблону:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаСервере</span>
<span class="keyword">Процедура</span> ПриЧтенииНаСервере<span class="operator">(</span>ТекущийОбъект<span class="operator">)</span>
 <span class="comment">// СтандартныеПодсистемы.ПодключаемыеКоманды</span>
 ПодключаемыеКомандыКлиентСервер<span class="operator">.</span>ОбновитьКоманды<span class="operator">(</span>ЭтотОбъект<span class="operator">,</span> <span class="operator">&lt;</span>ОбъектИлиТаблицаФормы<span class="operator">&gt;</span><span class="operator">)</span><span class="operator">;</span>
 <span class="comment">// Конец СтандартныеПодсистемы.ПодключаемыеКоманды</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoListBullet">&#9679; 
В обработчике <span class="Interface">ПриОткрытии</span> формы
следует вставить вызов по шаблону:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ПриОткрытии<span class="operator">(</span>Отказ<span class="operator">)</span>
 <span class="comment">// СтандартныеПодсистемы.ПодключаемыеКоманды</span>
 ПодключаемыеКомандыКлиент<span class="operator">.</span>НачатьОбновлениеКоманд<span class="operator">(</span>ЭтотОбъект<span class="operator">)</span><span class="operator">;</span>
 <span class="comment">// Конец СтандартныеПодсистемы.ПодключаемыеКоманды</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoListBullet">&#9679; 
Также рекомендуется вызывать процедуры
обновления видимости команд после изменения ключевых реквизитов (значения
которых могут быть использованы в условиях видимости команд):</p>

<p class="MsoListBullet2">&#9679;  <span class="Interface">ПодключаемыеКомандыКлиент</span>.<span class="Interface">НачатьОбновлениеКоманд</span> -
для обновления видимости команд на клиенте (подключает обработчик
ожидания <span class="Interface">Подключаемый_ОбновитьКоманды</span>).</p>

<p class="MsoListBullet2">&#9679;  <span class="Interface">ПодключаемыеКомандыКлиентСервер.ОбновитьКоманды</span> -
для обновления видимости команд на сервере (используется в случае, если в
процессе вызова уже делается серверный вызов).</p>

<p class="MsoListBullet">&#9679; 
Если форма является формой списка, тогда:</p>

<p class="MsoListBullet2">&#9679; 
В параметре &lt;<span class="Interface">ОбъектИлиТаблицаФормы</span>&gt; следует
передавать элемент формы типа <span class="Interface">ТаблицаФормы</span>, связанный
с динамическим списком. Например:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"> ПодключаемыеКомандыКлиент<span class="operator">.</span>ВыполнитьКоманду<span class="operator">(</span>ЭтотОбъект<span class="operator">,</span> Команда<span class="operator">,</span> Элементы<span class="operator">.</span>Список<span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoListBullet2">&#9679; 
В обработчике <span class="Interface">ПриАктивизацииСтроки</span> таблицы
формы следует вставить вызов по шаблону:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> <span class="operator">&lt;</span>ИмяТаблицы<span class="operator">&gt;</span>ПриАктивизацииСтроки<span class="operator">(</span>Элемент<span class="operator">)</span>
 <span class="comment">// СтандартныеПодсистемы.ПодключаемыеКоманды</span>
 ПодключаемыеКомандыКлиент<span class="operator">.</span>НачатьОбновлениеКоманд<span class="operator">(</span>ЭтотОбъект<span class="operator">)</span><span class="operator">;</span>
 <span class="comment">// Конец СтандартныеПодсистемы.ПодключаемыеКоманды</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="Paragraph0c">Внимание. Поле <span class="Interface">Ссылка</span> динамического
списка формы должно быть доступно в обработчике команды. Для этого необходимо в
свойствах поля <span class="Interface">Ссылка</span>, вложенного в реквизит
формы типа <span class="Interface">ДинамическийСписок</span>, включить
флажок <span class="Interface">Использовать всегда</span>.</p>

<p class="MsoListBullet">&#9679; 
Опционально. Добавить реквизит формы <span class="Interface">ПараметрыПодключаемыхКоманд</span> произвольного типа. Это
позволит не создавать реквизит формы динамически, что ускорит время открытия
формы.</p>

<a name="issogl2_настройка_исключений_поиска_ссылок_на_объекты"><h3>Настройка исключений поиска ссылок на объекты</h3></a>

<p class="Paragraph0c">В тех случаях, когда ссылки между объектами информационной
базы не являются значимыми для таких операций, как удаление объекта или поиск
ссылок на объект, необходимо настроить список исключений поиска ссылок в
функции <span class="Interface">ПриДобавленииИсключенийПоискаСсылок </span>в
переопределяемом модуле <span class="Interface">ОбщегоНазначенияПереопределяемый</span>.
</p>

<p class="Paragraph0c">Список исключений поиска ссылок может также использоваться
другими подсистемами или в функциональности конфигурации. См. также раздел «<A href="3.52. _25F3_25E4_25E0_25EB_25E5_25ED_25E8_25E5 _25EF_25EE_25EC_25E5_25F7_25E5_25ED_25ED_25FB_25F5 _25EE_25E1_25FA_25E5_25EA_25F2_25EE_25E2.htm@_=1504708101#_очистка_мест_использования">Удаление
помеченных объектов</a>».</p>

<p class="Paragraph0c">В частности, при анализе мест использования с помощью
функции <span class="Interface">ОбщегоНазначения.МестаИспользования</span> в
результатах поиска ссылающихся объектов не учитываются ссылки из этого списка
исключений. </p>

<a name="issogl2_настройка_пользовательского_интерфейса"><h3>Настройка пользовательского интерфейса</h3></a>

<p class="Paragraph0c">При запуске система автоматически устанавливает заголовок
окна программы по значению функции <span class="Interface">Пользователи.АвторизованныйПользователь</span>
и значению константы <span class="Interface">ЗаголовокСистемы</span>. </p>

<p class="Paragraph0c">Пример заголовка системы: </p>

<p class="Bullet0"><span class="Interface">Торговый дом «Ромашка» / Романова /
Бухгалтерия предприятия, редакция 2.0 / (1С:Предприятие)</span>.</p>

<p class="Paragraph0c">Если в конфигурации не используется подсистема «Настройки
программы», то в рабочем месте администратора программы необходимо разместить
константу <span class="Interface">ЗаголовокСистемы</span>. Для того чтобы
изменения вступили в силу, требуется вызвать процедуру <span class="Interface">УстановитьПроизвольныйЗаголовокПриложения</span>
общего модуля <span class="Interface">ОбщегоНазначенияКлиент</span>. См. пример в
форме <span class="Interface">ОбщиеНастройки</span> обработки <span class="Interface">ПанельАдминистрированияБСП</span>.</p>

<p class="Paragraph0c">Если в конфигурации не используется подсистема «Настройки
программы», то в рабочем месте администратора программы необходимо дополнительно
разместить:</p>

<p class="MsoListBullet">&#9679; 
общую команду <span class="Interface">УстановитьРасширениеРаботыСФайлами</span>,</p>

<p class="MsoListBullet">&#9679; 
обработку <span class="Interface">Журнал
регистрации</span>,</p>

<p class="MsoListBullet">&#9679; 
команду для вызова формы <span class="Interface">ПараметрыАдминистрированияСервернойИБ</span>
в форме административных настроек системы.</p>

<p class="Paragraph0c">См. пример размещения в формах обработки <span class="Interface">ПанельАдминистрированияБСП</span>.</p>

<p class="Paragraph0c">В форме персональных настроек следует разместить поле для
изменения настройки, управляющей подтверждением при закрытии программы. См.
пример реализации в демонстрационной конфигурации на закладке <span class="Interface">Общие формы _ДемоМоиНастройки</span>.</p>

<a name="issogl1_использование_при_разработке_конфигурации"><h2>Использование при разработке конфигурации</h2></a>

<a name="issogl2_программный_интерфейс"><h3>Программный интерфейс</h3></a>

<p class="Paragraph0c">Программный интерфейс подсистемы представлен экспортными
функциями общих модулей:</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ОбщегоНазначения</span>, <span class="Interface">ОбщегоНазначенияКлиент</span>, <span class="Interface">ОбщегоНазначенияКлиентСервер</span>,
<span class="Interface">ОбщегоНазначенияПереопределяемый</span>,</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">СтандартныеПодсистемыКлиентПовтИсп</span>,
</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">СтроковыеФункцииКлиентСервер</span>
и др.</p>

<a name="issogl2_выполнение_кода_при_запуске_системы"><h3>Выполнение кода при запуске системы</h3></a>

<p class="Paragraph0c">Действия, выполняемые перед началом работы системы, при
начале работы системы и перед завершением работы системы следует располагать в
процедурах общего модуля <span class="Interface">ОбщегоНазначенияКлиентПереопределяемый</span>:
<span class="Interface">ПередНачаломРаботыСистемы</span>, <span class="Interface">ПриНачалеРаботыСистемы</span>
и <span class="Interface">ПередЗавершениемРаботыСистемы</span> соответственно.
При этом следует учитывать, что при работе в модели сервиса данные процедуры
могут быть вызваны не только при осуществлении фактического входа (выхода)
пользователя из системы, но и при интерактивном входе (выходе) администратора
информационной базы в область данных.</p>

<p class="Paragraph0c">С целью минимизации количества серверных вызовов при
старте системы не рекомендуется напрямую вызывать серверные процедуры и функции
из кода модуля приложения и модуля управляемого приложения. Для передачи
клиенту параметров, необходимых для выполнения клиентского кода, следует
использовать функцию <span class="Interface">ПараметрыРаботыКлиентаПриЗапуске</span>
общего модуля <span class="Interface">СтандартныеПодсистемыКлиентПовтИсп</span>.
При первом вызове этой функции происходит одно обращение к серверу, после чего
полученное значение кешируется на клиенте для всех последующих вызовов этой
функции. </p>

<p class="Paragraph0c">При необходимости расширить количество передаваемых
параметров следует добавлять новые параметры в функцию <span class="Interface">ПараметрыРаботыКлиентаПриЗапуске</span>
переопределяемого общего модуля <span class="Interface">ОбщегоНазначенияПереопределяемый</span>.
Новые параметры рекомендуется помещать после параметров библиотечных подсистем
в произвольном порядке относительно друг друга, например: </p>

<p class="Paragraph0c"><span class="Interface">Параметры.Вставить(&quot;ИнформационнаяБазаФайловая&quot;,
ОбщегоНазначения.ИнформационнаяБазаФайловая());</span></p>

<p class="Paragraph0c">Аналогичный подход рекомендуется применять и для
взаимодействия с сервером при дальнейшей работе пользователя в программе. См.
функцию <span class="Interface">ПараметрыРаботыКлиента</span> переопределяемого
общего модуля <span class="Interface">ОбщегоНазначенияПереопределяемый</span>. </p>

<a name="_обновление_вспомогательных_данных"></a><a name="issogl2_обновление_вспомогательных_данных_во_время_разработки"><h3>Обновление вспомогательных данных во время разработки</h3></a>

<p class="Paragraph0c">В ряде случаев при разработке конфигурации может
потребоваться обновление вспомогательных данных, которые влияют на работу
программы: кеши некоторых свойств метаданных, служебные регистры сведений и т.
п.</p>

<p class="MsoListBullet">&#9679; 
Для полного обновления этих данных предназначена
внешняя обработка <span class="Interface">Инструменты разработчика: Обновление
вспомогательных данных</span>, которая входит в состав дистрибутива и в
демонстрационную конфигурацию.</p>

<p class="MsoListBullet">&#9679; 
Выполнить оптимальное обновление вспомогательных
данных можно следующим способом: указать параметр запуска <span class="Interface">ЗапуститьОбновлениеИнформационнойБазы</span> в конфигураторе
или через параметр командной строки <span class="Interface">/С</span>.</p>

<p class="MsoListBullet">&#9679; 
При закладке изменений в хранилище, которые
могут привести к необходимости обновления вспомогательных данных, можно
увеличивать номер версии конфигурации, тогда у других участников коллективной
разработки автоматически запустятся обязательные обработчики обновления.</p>

<a name="_использование_идентификаторов_объек"></a><a name="issogl2_использование_идентификаторов_объектов_метаданных"><h3>Использование идентификаторов объектов метаданных</h3></a>

<p class="Paragraph0c">При необходимости хранить в базе данных ссылку на объект
метаданных (например, ссылка на объект метаданных <span class="Interface">Справочник.Организации</span>)
рекомендуется вместо строкового реквизита с полным именем объекта метаданных
использовать ссылку на соответствующий элемент справочника <span class="Interface">ИдентификаторыОбъектовМетаданных</span> или <span class="Interface">ИдентификаторыОбъектовРасширений</span>. Такая потребность
возникает, например, в различных подсистемах БСП: для хранения настроек
версионирования данных, списка выбранных ролей в профилях групп доступа и т. п.</p>

<p class="Paragraph0c">Такой подход позволяет:</p>

<p class="MsoListBullet">&#9679; 
повысить производительность запросов, которые
обращаются к реквизитам данного типа;</p>

<p class="MsoListBullet">&#9679; 
снизить размер таблиц в базе данных, в которых
используются реквизиты данного типа;</p>

<p class="MsoListBullet">&#9679; 
выводить в пользовательском интерфейсе
представление ссылки вместо строкового имени объекта метаданных;</p>

<p class="MsoListBullet">&#9679; 
избавиться от разработки обработчиков обновления
и первоначального заполнения ИБ для актуализации строковых реквизитов с полными
именами объектов метаданных при изменениях метаданных конфигурации.</p>

<p class="Paragraph0c">Программно ссылку на объект метаданных можно получить с
помощью функции <span class="Interface">ИдентификаторОбъектаМетаданных</span>
общего модуля <span class="Interface">ОбщегоНазначения</span>.</p>

<p class="Paragraph0c">Справочник <span class="Interface">ИдентификаторыОбъектовМетаданных</span>
заполняется автоматически при первом запуске (и каждом обновлении) конфигурации
согласно метаданным конфигурации, а также автоматически актуализируется при
каждом обновлении версии конфигурации (учитываются переименованные, добавленные
и удаленные объекты метаданных). Полный список объектов метаданных (справочники,
документы, регистры и т. п.), обновление идентификаторов которых выполняется
автоматически, см. в комментарии к функции <span class="Interface">ИдентификаторОбъектаМетаданных</span>
общего модуля <span class="Interface">ОбщегоНазначения</span>. Справочник <span class="Interface">ИдентификаторыОбъектовРасширений</span> заполняется еще и при
добавлении расширений через общую форму <span class="Interface">УстановленныеРасширения</span>,
а также по требованию (при первом обращении из кода).</p>

<p class="Paragraph0c">Исключение составляют подсистемы и роли, обновление
идентификаторов которых требуется выполнять вручную. Необходимость обновления
идентификаторов подсистем и ролей возникает при их переименовании (а для
подсистем – также и в случае их перемещения из одной родительской подсистемы в
другую). В противном случае возможно рассогласование идентификаторов объектов
метаданных с объектами метаданных конфигурации.</p>

<p class="Paragraph0c">Для обновления идентификаторов необходимо воспользоваться
процедурой <span class="Interface">ПриДобавленииПереименованийОбъектовМетаданных</span>
общего модуля <span class="Interface">ОбщегоНазначенияПереопределяемый</span> и
увеличить номер версии конфигурации. Например, следующий фрагмент кода
описывает, что в версии конфигурации 2.0.1.2 подсистема <span class="Interface">_ДемоПоставляемыеДанные</span>
была перенесена из подсистемы <span class="Interface">_ДемоРаботаВМоделиСервиса</span>
в <span class="Interface">_ДемоАдминистрирование</span>:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ПриДобавленииПереименованийОбъектовМетаданных <span class="operator">(</span>Итог<span class="operator">)</span> <span class="keyword">Экспорт</span>
    ОбщегоНазначения<span class="operator">.</span>ДобавитьПереименование<span class="operator">(</span>Итог<span class="operator">,</span> <span class="string">&quot;2.0.1.2&quot;</span><span class="operator">,</span>
        <span class="string">&quot;Подсистема._ДемоРаботаВМоделиСервиса.Подсистема._ДемоПоставляемыеДанные&quot;</span><span class="operator">,</span>
        <span class="string">&quot;Подсистема._ДемоАдминистрирование.Подсистема._ДемоПоставляемыеДанные&quot;</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="Paragraph0c">Обновление идентификаторов выполняется последовательно по
версиям конфигурации, а в пределах одной версии – в порядке следования строк со
сведениями о переименованиях. Обновление идентификаторов для переименованных
подсистем выполняется также и для всех их дочерних подсистем (если они есть). </p>

<p class="Paragraph0c">Отдельным случаем, когда обновление идентификаторов
происходит автоматически, является переименование объектов метаданных с целью
изменения структуры данных с помощью создания новой копии объекта метаданных.
Такая необходимость возникает, когда реструктуризация объекта метаданных
невозможна. Например, при сокращении длины кода справочника <span class="Interface">Подразделения</span> с 50 до 11 может потребоваться создать
новый справочник, а старый переименовать в <span class="Interface">УдалитьПодразделения</span>.
В этом случае идентификатор справочника будет автоматически назначен новому справочнику
с тем же именем. </p>

<p class="Paragraph0c">Однако если при этом новый справочник будет назван иначе,
например <span class="Interface">СтруктурныеЕдиницы</span>, то потребуется
отразить переименование справочника <span class="Interface">Подразделения</span>
в справочник <span class="Interface">СтруктурныеЕдиницы</span>, как это описано
выше. </p>

<p class="Paragraph0c">При активной разработке конфигурации данные справочников <span class="Interface">ИдентификаторыОбъектовМетаданных</span> можно также обновлять
вручную, без увеличения номера версии конфигурации, с помощью обработки <span class="Interface">ИнструментыРазработчикаОбновлениеВспомогательныхДанных.epf</span>,
которая входит в состав дистрибутива и в демонстрационную конфигурацию. Однако
это допустимо только в случае, когда не производилось переименование ролей или
подсистем. В противном случае необходимо увеличить версию конфигурации и
вписать переименование в процедуру <span class="Interface">ПриДобавленииПереименованийОбъектовМетаданных</span>,
как написано выше. Если этого не сделать, то элемент справочника, который
соответствует роли или подсистеме, будет помечен на удаление и будет создан
новый, что приведет к рассогласованию идентификаторов объектов метаданных с объектами
метаданных конфигурации. Рассогласования можно исправить вручную. Для этого
нужно открыть форму элемента справочника <span class="Interface">ИдентификаторыОбъектовМетаданных</span>,
выполнить команду <span class="Interface">Включить возможность редактирования</span>
в меню <span class="Interface">Все действия</span> и задать соответствующее полное
имя.</p>

<a name="issogl2_версионирование_программных_интерфейсов"><h3>Версионирование программных интерфейсов</h3></a>

<p class="Paragraph0c">При разработке нескольких конфигураций, которые должны
взаимодействовать друг с другом (например, с помощью веб-сервисов или обмена
сообщениями), как правило, на стороне каждой из конфигураций реализуется
программный интерфейс, к которому обращается другая конфигурация. По мере
развития каждой из конфигураций часто возникает необходимость внесения
изменений в программные интерфейсы, предоставляемые этими конфигурациями своим
корреспондентам.</p>

<p class="Paragraph0c">В общем случае при изменении реализации программного
интерфейса (далее – просто интерфейса), например набора методов или структуры
их параметров, код вызывающей стороны становится неработающим, поскольку
поведение вызывающих методов «жестко» завязано на конкретную реализацию
интерфейса.</p>

<p class="Paragraph0c">Для исключения коллизий с некорректным использованием
измененного интерфейса следует использовать механизм версионирования
интерфейсов.</p>

<p class="Paragraph0c">Определения:</p>

<p class="MsoListBullet">&#9679; 
Семейство интерфейсов – набор интерфейсов,
решающих одну задачу и представленных в развитии реализации именами объектов
метаданных с постфиксами номеров версий.</p>

<p class="MsoListBullet">&#9679; 
Базовое имя интерфейсов семейства (или просто «базовое
имя») – имя его представителя без постфиксного номера версии.</p>

<p class="MsoListBullet">&#9679; 
Номер версии состоит из четырех групп,
разделенных точками. Каждая из этих групп может содержать исключительно числовое
значение. Например, <span class="Interface">2.0.1.6</span>.</p>

<p class="MsoListBullet">&#9679; 
Приращение номеров версий осуществляется
стандартным для версионирования ПО образом. Например, <span class="Interface">1.0.2.1,
1.0.2.2, … 1.0.3.1…</span> и т. д.</p>

<p class="MsoListBullet">&#9679; 
Интерфейс, носящий базовое имя, считается
интерфейсом версии <span class="Interface">1.0.1.1</span>.</p>

<p class="Paragraph0c">Действия на стороне, предоставляющей интерфейс (например,
веб-сервис <span class="Interface">MessageExchange</span>): </p>

<p class="MsoListBullet">&#9679; 
Создать интерфейс семейства с новой реализацией,
наименовав его по правилу: &lt;Базовое имя&gt; + «_» + &lt;Номер версии с подчеркиваниями
вместо точек&gt;. Например, <span class="Interface">MessageExchange_2_0_1_6</span>.</p>

<p class="MsoListBullet">&#9679; 
Присвоить семейству интерфейсов имя. Например, <span class="Interface">ОбменСообщениями</span>. Имя семейству интерфейсов присваивается
произвольно, исходя из его назначения.</p>

<p class="MsoListBullet">&#9679; 
В теле процедуры <span class="Interface">ПриОпределенииПоддерживаемыхВерсийПрограммныхИнтерфейсов</span>
общего модуля <span class="Interface">ОбщегоНазначенияПереопределяемый</span> к
секции подсистемы интерфейса добавить вставку нового номера версии, как
показано в примере описания процедуры. Если секция отсутствует, необходимо ее
создать.</p>

<p class="Paragraph0c">Действия на стороне, использующей интерфейс:</p>

<p class="MsoListBullet">&#9679; 
Механизм версионирования обслуживается
веб-сервисом <span class="Interface">InterfaceVersion</span>, доступ к которому
предоставляет роль <span class="Interface">УдаленныйДоступБазоваяФункциональность</span>.
Таким образом, функционирование механизма возможно только для пользователя,
обладающего этой ролью.</p>

<p class="MsoListBullet">&#9679; 
Перед вызовом методов интерфейса публикующей
стороны нужно запросить у нее список номеров поддерживаемых версий через вызов
функции <span class="Interface">ПолучитьВерсииИнтерфейса</span> общего модуля <span class="Interface">ОбщегоНазначения</span>, как показано в примере ее описания.
При этом в качестве параметра <span class="Interface">ИмяИнтерфейса</span> нужно
задать имя семейства интерфейсов.</p>

<p class="MsoListBullet">&#9679; 
В зависимости от полученного набора номеров
версий в логических ветках осуществлять вызовы тех или иных методов с актуальной
структурой параметров, обращаясь к конкретным интерфейсам семейства. </p>

<p class="Paragraph0c">Примеры использования можно найти в демонстрационной
конфигурации (см. вызовы функции <span class="Interface">ПолучитьВерсииИнтерфейса</span>).</p>

<a name="issogl2_безопасное_хранилище_паролей"><h3>Безопасное хранилище паролей</h3></a>

<p class="Paragraph0c">Для хранения паролей и другой конфиденциальной информации
следует использовать безопасное хранилище. Для помещения данных в безопасное
хранилище предназначена процедура <span class="Interface">ЗаписатьДанныеВБезопасноеХранилище</span>,
для получения ранее сохраненных данных – функция<span class="Interface"> ПрочитатьДанныеИзБезопасногоХранилища</span>,
а для удаления данных – функция<span class="Interface"> УдалитьДанныеИзБезопасногоХранилища
</span>общего модуля <span class="Interface">ОбщегоНазначения</span>.</p>

<p class="Paragraph0c">Если в форме необходимо разместить поле для ввода пароля,
то необходимо: </p>

<p class="MsoListBullet">&#9679; 
Создать реквизит формы с типом <span class="Interface">Строка</span>, включить свойство <span class="Interface">Сохраняемые
данные</span>, а также вспомогательный реквизит с типом <span class="Interface">Булево</span>
для фиксации факта изменения пароля. Например, <span class="Interface">Пароль</span>
и <span class="Interface">ПарольИзменен</span>. </p>

<p class="MsoListBullet">&#9679; 
Создать на форме поле со свойством <span class="Interface">РежимПароля = Да</span> и связать его с ранее созданным
реквизитом формы.</p>

<p class="MsoListBullet">&#9679; 
Для сведения к минимуму возможности получения
пароля злоумышленниками не следует при открытии формы присваивать его реквизиту
формы и передавать с сервера на клиент. Вместо этого в событие формы <span class="Interface">ПриСозданиеНаСервере</span> на сервере надо разместить
следующий код: </p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
    УстановитьПривилегированныйРежим(Истина);
    Пароли = ОбщегоНазначения.ПрочитатьДанныеИзБезопасногоХранилища(Объект.Ссылка, &quot;Пароль, ПарольSMTP&quot;);
    УстановитьПривилегированныйРежим(Ложь);
    Пароль = ?(ЗначениеЗаполнено(Пароли.Пароль), ЭтотОбъект.УникальныйИдентификатор, &quot;&quot;);
    ПарольSMTP = ?(ЗначениеЗаполнено(Пароли.ПарольSMTP), ЭтотОбъект.УникальныйИдентификатор, &quot;&quot;);
</pre>

<p class="MsoListBullet">&#9679; 
В событие <span class="Interface">ПриЗаписиНаСервере</span>:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
    Если ПарольИзменен Тогда
        УстановитьПривилегированныйРежим(Истина);
        ОбщегоНазначения.ЗаписатьДанныеВБезопасноеХранилище(ТекущийОбъект.Ссылка, Пароль);
        УстановитьПривилегированныйРежим(Ложь);
    КонецЕсли;
    Если ПарольSMTPИзменен Тогда
        УстановитьПривилегированныйРежим(Истина);
        ОбщегоНазначения.ЗаписатьДанныеВБезопасноеХранилище(ТекущийОбъект.Ссылка, ПарольSMTP, &quot;ПарольSMTP&quot;);
        УстановитьПривилегированныйРежим(Ложь);
    КонецЕсли;
</pre>

<p class="MsoListBullet">&#9679; 
В модуле объекта разместить следующий код в событие<span class="Interface"> ПередУдалением</span>:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
    УстановитьПривилегированныйРежим(Истина);
    ОбщегоНазначения.УдалитьДанныеИзБезопасногоХранилища(Ссылка);
    УстановитьПривилегированныйРежим(Ложь);
</pre>

<p class="Paragraph0c">См. пример в форме <span class="Interface">ФормаЭлемента</span>
справочника <span class="Interface">УчетныеЗаписиЭлектроннойПочты</span>.</p>

<a name="issogl2_стандартные_роли_и_дополнительные_права"><h3>Стандартные роли и дополнительные права</h3></a>

<p class="Paragraph0c">Библиотека не навязывает ту или иную методику разработки
ролей в конфигурации. В общем виде при разработке системы ролей могут
использоваться два подхода, которые различаются степенью детализации
(укрупненности) ролей:</p>

<p class="Number81">1. 
При первом подходе проектируются <span class="Interface">прикладные роли</span>, предоставляющие доступ ко всему
множеству объектов метаданных, которые требуются для работы определенной
категории пользователей системы. Например, «Бухгалтер», «Кассир» и т. д. Такие
роли самостоятельно назначают пользователям (группам пользователей) и, как
правило, расширяют дополнительными правами, например: «Действия главного
бухгалтера», «Печать непроведенных документов», «Запуск тонкого клиента» и т.
п.</p>

<p class="Number81">2. 
Во втором случае проектируются <span class="Interface">роли-функции</span>, предоставляющие «атомарный» доступ к
определенному подмножеству объектов метаданных, с которым различные
пользователи могут работать как с одной функцией системы. Такие роли не назначаются
пользователям поодиночке, а объединяются в профили групп доступа и назначаются
пользователям (группам пользователей) в совокупности. При этом профили групп
доступа выступают аналогами прикладных ролей, например: «Бухгалтер», «Кассир» и
т. д.</p>

<p class="Paragraph0c">В состав библиотеки входят роли, которые можно
использовать для настройки доступа пользователей к объектам информационной базы
в обоих перечисленных случаях:</p>

<p class="Number81">1. 
Обязательные роли.</p>

<p class="Number81">2. 
Роли, общие для нескольких подсистем.</p>

<p class="Number81">3. 
Роли, поставляемые в составе отдельных подсистем
(приведены в разделах по настройке конкретных подсистем).</p>

<p class="Paragraph0c">Обязательные роли должны всегда присутствовать в
конфигурации, в то время как остальные роли из состава библиотеки являются
опциональными: в определенных случаях они могут быть удалены из конфигурации.</p>

<a name="issogl3_обязательные_роли"><h4>Обязательные роли</h4></a>

<p class="Objectname">Таблица 3.7.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">№</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Роли и их назначение</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="TextinTable81">1.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ПолныеПрава</span></p>
  <p class="TextinTable81">Обязательная роль, которая предоставляет
  неограниченный доступ ко всем прикладным данным, но не дает прав доступа для
  администрирования информационной базы в целом (обновление конфигурации,
  работа в конфигураторе и т. п.). Включает все права доступа, кроме права
  интерактивного удаления.</p>
  <p class="TextinTable81">При работе в модели сервиса назначается
  администраторам абонентов (областей данных) и предоставляет неограниченный
  доступ ко всем данным текущей области, а также позволяет выполнять
  администрирование пользователей, настройку программы, удаление помеченных
  объектов и другие административные действия с областью данных.</p>
  <p class="TextinTable81">При работе в локальном режиме назначается совместно с
  ролью <span class="Interface">АдминистраторСистемы</span> для администрирования.</p>
  <p class="TextinTable81">В базовых версиях конфигурации роль <span class="Interface">ПолныеПрава</span> предоставляет неограниченный доступ ко
  всем данным и конфигурации информационной базы</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">2.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">АдминистраторСистемы</span></p>
  <p class="TextinTable81">Обязательная роль, предоставляющая права
  администрирования информационной базы в целом (обновление конфигурации,
  работа в конфигураторе и т. п.).</p>
  <p class="TextinTable81">Назначается пользователям только совместно с ролью <span class="Interface">ПолныеПрава</span>.</p>
  <p class="TextinTable81">При работе в модели сервиса используется для
  администраторов сервиса. Включает неограниченный доступ ко всем неразделенным
  данным, кроме права интерактивного удаления.</p>
  <p class="TextinTable81">В базовых версиях конфигурации роль <span class="Interface">АдминистраторСистемы</span> не используется</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">3.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Администрирование</span></p>
  <p class="TextinTable81">Предоставляет права «Административные функции» и
  «Активные пользователи»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">4.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ЗапускВебКлиента</span></p>
  <p class="TextinTable81">Предоставляет право «Веб-клиент»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">5.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ЗапускТонкогоКлиента</span></p>
  <p class="TextinTable81">Предоставляет право «Тонкий клиент»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">6.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ЗапускТолстогоКлиента</span></p>
  <p class="TextinTable81">Предоставляет право «Толстый клиент»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">7.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ЗапускВнешнегоСоединения</span></p>
  <p class="TextinTable81">Предоставляет право «Внешнее соединение»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">8.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ЗапускAutomation</span></p>
  <p class="TextinTable81">Предоставляет право «Automation»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">9.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ИнтерактивноеОткрытиеВнешнихОтчетовИОбработок</span></p>
  <p class="TextinTable81">Предоставляет права «Интерактивное открытие внешних
  отчетов» и «Интерактивное открытие внешних обработок»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">10.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ОбновлениеКонфигурацииБазыДанных</span></p>
  <p class="TextinTable81">Предоставляет право «Обновление конфигурации базы
  данных»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">11.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ВыводНаПринтерФайлБуферОбмена</span></p>
  <p class="TextinTable81">Предоставляет право «Вывод»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">12.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ПросмотрЖурналаРегистрации</span></p>
  <p class="TextinTable81">Предоставляет право «Журнал регистрации»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">13.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">РежимВсеФункции</span></p>
  <p class="TextinTable81">Предоставляет право «Режим &quot;Все функции&quot;»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">14.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">СохранениеДанныхПользователя</span></p>
  <p class="TextinTable81">Предоставляет право «Сохранение данных пользователя»</p>
  </td>
 </tr>
</table>

<a name="issogl3_роли_общие_для_нескольких_подсистем"><h4>Роли, общие для нескольких подсистем</h4></a>

<p class="Paragraph0c">В отличие от ролей, поставляемых в составе отдельных
подсистем, данная группа ролей предоставляет доступ к объектам сразу нескольких
подсистем. </p>

<p class="Objectname">Таблица 3.8.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">№</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Роли и их назначение</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="TextinTable81">1.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">БазовыеПрава</span></p>
  <p class="TextinTable81">Роль, предоставляющая доступ к тем объектам
  информационной базы, которые должны быть всегда доступны всем пользователям.</p>
  <p class="TextinTable81">Назначается всем пользователям</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">2.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">БазовыеПраваВнешнегоПользователя</span></p>
  <p class="TextinTable81">Роль, предоставляющая доступ к тем объектам
  информационной базы, которые должны быть всегда доступны всем внешним пользователям.</p>
  <p class="TextinTable81">Назначается всем внешним пользователям</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">3.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">УдаленныйДоступБазоваяФункциональность</span></p>
  <p class="TextinTable81">Предоставляет доступ к вызовам операций веб-сервисов
  подсистемы «Базовая функциональность»</p>
  </td>
 </tr>
</table>

<p class="Paragraph0c">Далее рассмотрим подробнее, каким образом библиотечные
роли следует применять при использовании обоих подходов к разработке системы
ролей в конфигурации.</p>

<a name="issogl2_подход_1_прикладные_роли_и_дополнительные_права"><h3>Подход № 1. Прикладные роли и дополнительные права</h3></a>

<p class="Paragraph0c">В простейшем случае роль соответствует функциональным
обязанностям определенной категории пользователей системы, например:
«Бухгалтер», «Кассир». Такие прикладные роли применимы в конфигурациях, в
которых функциональные обязанности пользователей заранее известны и не
предполагают изменений на внедрениях.</p>

<p class="Paragraph0c">Совместно с прикладными ролями пользователям могут назначаться
одна или несколько ролей, предоставляющих дополнительные права. Название роли,
предоставляющей дополнительные права на определенные действия, должно описывать
эти действия, например: «Действия главного бухгалтера», «Печать непроведенных
документов», «Запуск тонкого клиента», «Удаление помеченных объектов» и т. п.
Не следует применять в именах ролей слово «право» (исключения составляют
обязательные роли <span class="Interface">ПолныеПрава</span>, <span class="Interface">БазовыеПрава</span> и <span class="Interface">БазовыеПраваВнешнегоПользователя</span>).</p>

<p class="Paragraph0c">Роли, предоставляющие дополнительные права, не
предназначены для самостоятельного использования, они применяются в комбинации
с прикладной ролью и служат для расширения доступа к данным той или иной
прикладной области. Например:</p>

<p class="MsoListBullet">&#9679; 
роль «Действия генерального директора» может
назначаться пользователям только совместно с «прикладной» ролью «Генеральный
директор»;</p>

<p class="MsoListBullet">&#9679; 
роль «Действия главного бухгалтера» – только
вместе с ролью «Бухгалтер»;</p>

<p class="MsoListBullet">&#9679; 
роль «Печать непроведенных документов» может
использоваться совместно с произвольной «прикладной» ролью.</p>

<p class="Paragraph0c">Перед началом работы конфигурации следует проверить состав
ролей текущего пользователя. Если пользователю не назначена хотя бы одна
прикладная роль, предполагающая самостоятельное использование, работа
пользователя не может быть продолжена.</p>

<p class="Paragraph0c"><span class="Interface">Если в конфигурации не используется
подсистема «Управление доступом»</span>, то для упрощения администрирования
прав пользователей рекомендуется оставить в конфигурации только обязательные
роли, удалив все остальные библиотечные роли. Следует также удалить
обязательную роль <span class="Interface">Базовые права</span>, а ее состав прав
включить в одну или несколько прикладных ролей. </p>

<p class="Paragraph0c"><span class="Interface">При использовании подсистемы
«Управление доступом» </span>допускается оставить в конфигурации все
библиотечные роли как есть и рекомендуется подготовить типовые профили групп
доступа пользователей. Подробнее о настройке профилей групп доступа с помощью
возможностей подсистемы «Управление доступом» см. в разделе «<A href="3.53. _25F3_25EF_25F0_25E0_25E2_25EB_25E5_25ED_25E8_25E5 _25E4_25EE_25F1_25F2_25F3_25EF_25EE_25EC.htm@_=1504708101#_управление_доступом">Управление
доступом</a>».</p>

<a name="issogl2_подход_2_роли-функции"><h3>Подход № 2. Роли-функции</h3></a>

<p class="Paragraph0c">Если функциональные обязанности пользователей конфигурации
не известны на этапе разработки, а определяются на конкретном внедрении,
прикладные роли следует разделять на более специализированные роли,
декомпозируя их до уровня отдельных ролей-функций. </p>

<p class="Paragraph0c">Роли-функции не предназначены для самостоятельного
использования, а назначаются пользователям (группам пользователей) всегда в
комбинации с другими ролями-функциями. Совокупность ролей-функций,
предоставляющих определенной категории пользователей необходимый набор прав для
выполнения своих обязанностей, образует профиль группы доступа. Например,
профиль «Менеджер по продажам» может включать такие роли-функции, как
«Добавление и изменение заказов покупателей» и «Чтение нормативно-справочной
информации», а «Начальник отдела продаж» – «Добавление и изменение заказов
покупателей», «Добавление и изменение нормативно-справочной информации» и
«Печать непроведенных документов».</p>

<p class="Paragraph0c">Настройка прав пользователей с помощью отдельных
ролей-функций не требует внесения изменений в конфигурацию как на этапе
внедрения, так и на этапе эксплуатации (администрирования) информационной
системы.</p>

<p class="Paragraph0c">При проектировании роли-функции нужно учитывать, что она
участвует в формировании пользовательского интерфейса. Поэтому для достижения
гибкости управления пользовательским интерфейсом могут потребоваться «атомарные»
роли, которые предоставляют доступ к одному объекту метаданных.</p>

<p class="Paragraph0c">Так в случае с объектами метаданных, которые используются
в качестве разрезов ограничения доступа (например, организаций, складов,
контрагентов, касс и др.), для чтения лучше создавать «атомарные роли», т. к.
они будут использоваться в сочетании с ролями – например, для доступа к
документам. При таком подходе, например, в интерфейс кладовщика не попадет
доступ к списку касс, который ему не требуется, что соответствует принципу
управляемого интерфейса.</p>

<p class="Paragraph0c"><span class="Interface">Для реализации подхода № 2
рекомендуется внедрение в конфигурацию подсистемы «Управление доступом»</span>.
Подробнее о настройке профилей групп доступа с помощью возможностей подсистемы
«Управление доступом» см. в разделе «<A href="3.53. _25F3_25EF_25F0_25E0_25E2_25EB_25E5_25ED_25E8_25E5 _25E4_25EE_25F1_25F2_25F3_25EF_25EE_25EC.htm@_=1504708101#_управление_доступом">Управление доступом</a>».</p>

<a name="issogl3_требования_к_наименованию_ролей-функций"><h4>Требования к наименованию ролей-функций</h4></a>

<p class="Paragraph0c">Название роли-функции рекомендуется начинать с описания
действия, которое она позволяет выполнить пользователю в информационной
системе:</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">Чтение</span> – для права чтения
и просмотра, например: <span class="Interface">ЧтениеЗаказов</span>, <span class="Interface">ЧтениеНормативноСправочнойИнформации</span> и т. п.;</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ДобавлениеИзменение</span>
– для права добавления, которое должно сочетаться с правом изменения добавленного,
правами чтения и просмотра, например, <span class="Interface">ДобавлениеИзменениеЗаказов</span>;</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">Изменение</span> – для
права изменения, например <span class="Interface">ИзменениеЗадач</span>;</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">Редактирование</span> –
для права интерактивного редактирования, которое должно сочетаться с правом
изменения того, что редактируется, например <span class="Interface">РедактированиеЗадач</span>;</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">Просмотр</span> – для
права интерактивного просмотра, которое должно сочетаться с правом чтения того,
что просматривается, например <span class="Interface">ПросмотрПартнеров</span>;</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ПометкаУдаления</span> –
для права интерактивной установки пометки удаления, которое должно сочетаться с
правом изменения того, что помечается на удаление, например <span class="Interface">ПометкаУдаленияБизнесПроцессов</span>.</p>

<p class="Paragraph0c">Если роль дает права сразу на несколько действий, то в
синониме роли их следует перечислять через запятую и соединять союзом «и»,
например: «Чтение заказов покупателей», «Добавление и изменение
нормативно-справочной информации», «Добавление и изменение заказов
покупателей».</p>

<a name="issogl3_управление_командным_интерфейсом_с_помощью_ролей-функций"><h4>Управление командным интерфейсом с помощью ролей-функций</h4></a>

<p class="Paragraph0c">Видимость элементов пользовательского интерфейса в
зависимости от прав пользователей рекомендуется задавать в соответствующих
ролях-функциях. Например, в роль «Чтение заказов покупателей» следует включать
общие команды, которые открывают формы заказов покупателей.</p>

<p class="Paragraph0c">Однако в некоторых случаях все же необходимо заводить
дополнительные роли для управления командным интерфейсом. Как правило, такие
интерфейсные роли не содержат ограничений доступа к данным, а связываются
непосредственно с реквизитами объектов, элементами форм и командами. Их наличие
у текущего пользователя может также программно проверяться из кода на
встроенном языке.</p>

<p class="Paragraph0c">Название интерфейсной роли должно описывать разрешенное
действие, например «Просмотр контактной информации». Исключение составляют
роли, которые предоставляют доступ к разделам командного интерфейса (просмотр
подсистем). Такие роли начинаются со слова «Раздел», например: <span class="Interface">РазделЗапасыИЗакупки</span>, <span class="Interface">РазделПродажи</span>,
<span class="Interface">РазделПродажиИПроведениеСделок</span>, <span class="Interface">РазделПродажиИВозвраты</span>, <span class="Interface">РазделПродажиРозничныеПродажи</span>.</p>

<p class="Paragraph0c">Примеры интерфейсных ролей приведены ниже.</p>

<p class="Objectname">Таблица 3.9.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">№</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Роли и их назначение</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="TextinTable81">1.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">&lt;Раздел нормативно-справочная
  информация&gt;</span></p>
  <p class="TextinTable81">Роль управляет видимостью раздела командного
  интерфейса, в котором размещены команды открытия форм объектов метаданных,
  относящихся к нормативно-справочной информации, например: форма списка
  справочника <span class="Interface">Валюты</span>, адресного классификатора и
  т. п.</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">2.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">&lt;Раздел совместная работа&gt;</span></p>
  <p class="TextinTable81">Роль управляет видимостью раздела командного
  интерфейса, используемого для работы с задачами и бизнес-процессами</p>
  </td>
 </tr>
</table>

<p class="Paragraph0c">Примеры настройки прав доступа пользователей приведены
ниже.</p>

<p class="Objectname">Таблица 3.10.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">№</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Группа пользователей и ее
   функции</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Состав ролей</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="TextinTable81">1. 
   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Администратор:</p>
  <p class="BulletTab">&#9679; 
  имеет полный доступ к системе,</p>
  <p class="BulletTab"><span class="Interface">&#9679;  </span>выполняет
  настройку прав (состав ролей) и ограничений доступа</p>
  </td>
  <td valign="top">
  <p class="BulletTab">&#9679; 
  <span class="Interface">АдминистраторСистемы</span>,</p>
  <p class="BulletTab"><span class="Interface">&#9679;  </span><span class="Interface">ПолныеПрава</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">2. 
   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Ответственный за нормативно-справочную информацию</p>
  </td>
  <td valign="top">
  <p class="BulletTab">&#9679; 
  <span class="Interface">ЗапускТонкогоКлиента</span>,</p>
  <p class="BulletTab">&#9679; 
  <span class="Interface">БазовыеПрава</span>,</p>
  <p class="BulletTab">&#9679; 
  <span class="Interface">ДобавлениеИзменениеАдресныхСведений</span>,</p>
  <p class="BulletTab">&#9679; 
  <span class="Interface">ДобавлениеИзменениеБанков</span>,</p>
  <p class="BulletTab">&#9679; 
  <span class="Interface">ДобавлениеИзменениеКалендарныхГрафиков</span>,</p>
  <p class="BulletTab">&#9679; 
  <span class="Interface">ДобавлениеИзменениеДополнительныхРеквизитовИСведений</span>,</p>
  <p class="BulletTab">&#9679; 
  <span class="Interface">ДобавлениеИзменениеКурсовВалют</span>,</p>
  <p class="BulletTab">&#9679; 
  <span class="Interface">ДобавлениеИзменениеГрафиковРаботы</span>,</p>
  <p class="BulletTab">&#9679; 
  <span class="Interface">ДобавлениеИзменениеВидовКонтактнойИнформации</span>,</p>
  <p class="BulletTab"><span class="Interface">&#9679;  </span><span class="Interface">&lt;Раздел нормативно-справочная
  информация&gt;</span></p>
  </td>
 </tr>
</table>

<a name="_контроль_замены_ссылок"></a><a name="issogl2_контроль_замены_ссылок_при_записи_объектов_и_выполнение_связанных_действий"><h3>Контроль замены ссылок при записи объектов и выполнение связанных действий</h3></a>

<p class="Paragraph0c">При замене ссылок в документах (<A href="3.34. _25EF_25EE_25E8_25F1_25EA _25E8 _25F3_25E4_25E0_25EB_25E5_25ED_25E8_25E5 _25E4_25F3_25E1_25EB_25E5_25E9.htm@_=1504708101#_поиск_и_удаление">поиске и удалении дублей</a> или программном вызове <span class="Interface">ОбщегоНазанчения.ЗаменитьСсылки</span>) документы записываются
без перепроведения, чтобы не нарушать последовательности. Как следствие, не
срабатывает событие <span class="Interface">ОбработкаПроведения</span> и вся
прикладная логика проведения по регистрам. Однако в некоторых случаях при
замене ссылок может потребоваться выполнять часть этой логики. Для этого в
события записи объектов (<span class="Interface">ПередЗаписью</span> и <span class="Interface">ПриЗаписи</span>) через <span class="Interface">ДополнительныеСвойства</span>
передаются параметры:</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ЗаменаСсылок – Булево – Истина</span>.
Позволяет определить, что отработал механизм замены ссылок.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ВыполненныеЗамены – Массив</span>.
Описание выполненных замен. Элементы типа <span class="Interface">Структура</span>
с полями:</p>

<p class="MsoListBullet2">&#9679;  <span class="Interface">СсылкаДубля –</span> <span class="Interface">Произвольный</span>.
Элемент, который был заменен.</p>

<p class="MsoListBullet2">&#9679;  <span class="Interface">СсылкаОригинала – Произвольный</span>. Элемент, на который
выполнена замена.</p>

<p class="MsoListBullet2">&#9679;  <span class="Interface">ВидРеквизита – Строка</span>. Вид реквизита, в котором
выполнена замена. Может принимать следующие значения: <span class="Interface">Реквизиты</span>,
<span class="Interface">СтандартныеРеквизиты</span>, <span class="Interface">ТабличныеЧасти</span>,
<span class="Interface">СтандартныеТабличныеЧасти</span>, <span class="Interface">Движения</span>,
<span class="Interface">Последовательности</span>, <span class="Interface">НаборЗаписей</span>.</p>

<p class="MsoListBullet2">&#9679;  <span class="Interface">ИмяРеквизита – Строка</span>. Имя реквизита или имя табличной
части.</p>

<p class="MsoListBullet2">&#9679;  <span class="Interface">Индекс – Число</span>, <span class="Interface">Неопределено</span>.
Индекс строки, в которой выполнена замена дубля на оригинал. Заполняется в
случае, когда замена выполнена в табличной части.</p>

<p class="MsoListBullet2">&#9679;  <span class="Interface">ИмяКолонки – Строка</span>, <span class="Interface">Неопределено</span>.
Имя колонки, в которой выполнена замена дубля на оригинал. Заполняется в случае,
когда замена выполнена в табличной части.</p>

<p class="Paragraph0c">Эти параметры можно использовать для того, чтобы
определить, «где» и «что именно было изменено» и при необходимости выполнить
связанные действия. Например, создать ключи аналитики и выполнить их замену в
регистрах.</p>

<a name="_подключение_отчетов_и"></a><a name="issogl2_подключение_отчетов_и_обработок_к_другим_объектам_метаданных"><h3>Подключение отчетов и обработок к другим объектам метаданных</h3></a>

<p class="Paragraph0c">В отчетах и обработках конфигурации и расширений можно
подключать дополнительные команды к тем объектам, в которые внедрены «<A href="3.33. _25EF_25E5_25F7_25E0_25F2_25FC.htm@_=1504708101#_печать">Печать</a>» или
«<a href="#_заполнение_объектов">Заполнение
объектов</a>». Для этого:</p>

<p class="MsoListBullet">&#9679; 
Отчет или обработка должна входить в состав
подсистемы <span class="Interface">ПодключаемыеОтчетыИОбработки</span>.</p>

<p class="MsoListBullet">&#9679; 
В ее модуле менеджера должна быть определена процедура
<span class="Interface">ПриОпределенииНастроек</span> по шаблону:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">#Область ПрограммныйИнтерфейс</span>
<span class="comment">// Определяет состав программного интерфейса для интеграции с конфигурацией.</span>
<span class="comment">//</span>
<span class="comment">// Параметры:</span>
<span class="comment">//   Настройки - Структура - Настройки интеграции этого объекта.</span>
<span class="comment">//       См. возвращаемое значение функции ПодключаемыеКоманды.НастройкиПодключаемыхОтчетовИОбработок().</span>
<span class="comment">//</span>
<span class="keyword">Процедура</span> ПриОпределенииНастроек<span class="operator">(</span>Настройки<span class="operator">)</span> <span class="keyword">Экспорт</span>
    <span class="comment">// Пример:</span>
    <span class="comment">//Настройки.Размещение.Добавить(Метаданные.Документы.ИмяДокумента);</span>
    <span class="comment">//Настройки.ДобавитьКомандыПечати = Истина;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">#КонецОбласти</span></pre>

<p class="MsoListBullet">&#9679; 
Подробное описание процедур <span class="Interface">ДобавитьКомандыПечати</span> и <span class="Interface">ДобавитьКомандыЗаполнения</span>
и их параметров см. в документации к подсистемам «<span class="MsoHyperlink"><A href="3.33. _25EF_25E5_25F7_25E0_25F2_25FC.htm@_=1504708101#_печать">Печать</a></span>» и «<span class="MsoHyperlink"><a href="#_заполнение_объектов">Заполнение объектов</a></span>».</p>

<a name="issogl2_настройка_обмена_данными"><h3>Настройка обмена данными</h3></a>

<p class="Paragraph0c">Для настройки обмена данными следует руководствоваться
общими правилами.</p>

<p class="Paragraph0c">В планы обмена распределенной информационной базы (РИБ)
рекомендуется включать все объекты метаданных подсистемы, кроме перечисленных:</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">АвтоматическиНастраиватьРазрешенияВПрофиляхБезопасности</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">АдресПубликацииИнформационнойБазыВИнтернете</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">АдресПубликацииИнформационнойБазыВЛокальнойСети</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">ГлавныйУзел</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">ЗаголовокСистемы</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">ИдентификаторИнформационнойБазы</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">ИспользоватьРазделениеПоОбластямДанных</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">ИспользуютсяПрофилиБезопасности</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">НеИспользоватьРазделениеПоОбластямДанных</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">ПрофильБезопасностиИнформационнойБазы</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">ЭтоАвтономноеРабочееМесто</span>,</p>

<p class="MsoListBullet">&#9679; 
справочник <span class="Interface">ВерсииРасширений</span>,</p>

<p class="MsoListBullet">&#9679; 
справочник <span class="Interface">ИдентификаторыОбъектовРасширений</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">БезопасноеХранилищеДанных</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">БезопасноеХранилищеДанныхОбластейДанных</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">ЗапросыРазрешенийНаИспользованиеВнешнихРесурсов</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">ИдентификаторыОбъектовВерсийРасширений</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">ПараметрыРаботыВерсийРасширений</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">РазрешенияНаИспользованиеВнешнихРесурсов</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">РежимыПодключенияВнешнихМодулей</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">СеансыВерсийРасширений</span>.</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">КэшПрограммныхИнтерфейсов</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">НеразделенныеПользователи</span>.</p>

<p class="Paragraph0c">В планах обмена распределенной информационной базы (РИБ)
рекомендуется отключать регистрацию изменений для следующих объектов метаданных
подсистемы (см. также раздел «<A href="3.28. _25EE_25E1_25EC_25E5_25ED _25E4_25E0_25ED_25ED_25FB_25EC_25E8.htm@_=1504708101#_особенности_создания_начального">Особенности создания начального образа
подчиненного узла распределенной ИБ</a>»):</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">ПараметрыСлужебныхСобытий</span>.</p>

<p class="Paragraph0c">Из остальных планов обмена (не РИБ) рекомендуется
исключать следующие объекты метаданных:</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">ПараметрыПодключаемыхКоманд</span>,</p>

<p class="MsoListBullet">&#9679; 
константа <span class="Interface">ПараметрыСлужебныхСобытий</span>,</p>

<p class="MsoListBullet">&#9679; 
справочник <span class="Interface">ВерсииРасширений</span>,</p>

<p class="MsoListBullet">&#9679; 
справочник <span class="Interface">ИдентификаторыОбъектовМетаданных</span>,</p>

<p class="MsoListBullet">&#9679; 
справочник <span class="Interface">ИдентификаторыОбъектовРасширений</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">ИдентификаторыОбъектовВерсийРасширений</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">ПараметрыРаботыВерсийРасширений</span>,</p>

<p class="MsoListBullet">&#9679; 
регистр сведений <span class="Interface">СеансыВерсийРасширений</span>.</p>

<a name="issogl2_настройка_рабочей_даты_пользователя"><h3>Настройка рабочей даты пользователя</h3></a>

<p class="Paragraph0c">Довольно часто на практике информация в учетные системы
вводится не сразу в момент совершения операции, а позже по времени (задним
числом). Например, фактическое поступление на склад товаров от поставщика может
произойти раньше, чем будут получены соответствующие финансовые документы.
Задним числом чаще всего работают бухгалтеры, отражающие уже свершившиеся ранее
факты хозяйственной жизни. </p>

<p class="Paragraph0c">Поэтому для удобства пользователей разработчик
конфигурации может предусмотреть возможность настройки даты, которую необходимо
подставлять в новые документы, – так называемой «рабочей даты».</p>

<p class="Paragraph0c">В общем модуле <span class="Interface">ОбщегоНазначения</span>
расположены процедура и функции для программного управления такой настройкой:</p>

<p class="MsoListBullet">&#9679; 
процедура <span class="Interface">УстановитьРабочуюДатуПользователя</span>,</p>

<p class="MsoListBullet">&#9679; 
функция <span class="Interface">РабочаяДатаПользователя</span>,</p>

<p class="MsoListBullet">&#9679; 
функция <span class="Interface">ТекущаяДатаПользователя</span>.</p>

<p class="Paragraph0c">Пример их использования приведен в демонстрационной
конфигурации в модуле общей формы <span class="Interface">_ДемоМоиНастройки</span>.
С помощью переключателя на форме пользователь может выбрать в качестве даты
создания документа текущую дату компьютера либо иную указанную дату.</p>

<p class="Paragraph0c">Сведения о рабочей дате сохраняются в хранилище общих
настроек информационной базы, для использования которого необходимо, чтобы пользователю
была назначена роль <span class="Interface">СохранениеДанныхПользователя</span>.</p>

<p class="Paragraph0c">При создании новых документов для заполнения их даты из
настройки пользователя можно использовать подписки на события <span class="Interface">ОбработкаЗаполнения и ПриКопировании</span> (см. в
демонстрационной конфигурации подписки на события <span class="Interface">_ДемоЗаполнитьДатуДокументаПоРабочейДате</span>
и <span class="Interface">_ДемоЗаполнитьДатуДокументаПоРабочейДатеПриКопировании</span>).
</p>

<p class="Paragraph0c">При использовании подписок на события необходимо
учитывать, что их обработчики вызываются после того, как будет выполнен
обработчик события в модуле объекта. Поэтому если алгоритм автоматического
заполнения данных нового документа использует его дату, то установку даты
документа из настройки рабочей даты следует выполнить в самом начале процедуры
– обработчика события.</p>

<a name="issogl2_расширение_видов_подключаемых_команд"><h3>Расширение видов подключаемых команд</h3></a>

<p class="Paragraph0c">Для этого в модуле <span class="Interface">ПодключаемыеКомандыПереопределяемый</span>:</p>

<p class="MsoListBullet">&#9679; 
В процедуре <span class="Interface">ПриОпределенииВидовПодключаемыхКоманд</span> добавить
вид подключаемых команд и описать умолчания для вывода подменю с командами
этого вида. Например:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ПриОпределенииВидовПодключаемыхКоманд<span class="operator">(</span>ВидыПодключаемыхКоманд<span class="operator">)</span> <span class="keyword">Экспорт</span>
 Вид <span class="operator">=</span> ВидыПодключаемыхКоманд<span class="operator">.</span>Добавить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
 Вид<span class="operator">.</span>Имя <span class="operator">=</span> <span class="string">&quot;&lt;ИмяВидаКоманд&gt;&quot;</span><span class="operator">;</span>
 Вид<span class="operator">.</span>ИмяПодменю <span class="operator">=</span> <span class="string">&quot;&lt;ИмяПодменю&gt;&quot;</span><span class="operator">;</span>
 Вид<span class="operator">.</span>Заголовок <span class="operator">=</span> НСтр<span class="operator">(</span><span class="string">&quot;ru = '&lt;Заголовок подменю&gt;'&quot;</span><span class="operator">)</span><span class="operator">;</span>
 Вид<span class="operator">.</span>Картинка <span class="operator">=</span> БиблиотекаКартинок<span class="operator">.</span><span class="operator">&lt;</span>ИмяКартинкиПодменю<span class="operator">&gt;</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoListBullet">&#9679; 
Если нужна возможность разрабатывать и
подключать команды данного вида при помощи расширений, тогда в процедуре <span class="Interface">ПриОпределенииСоставаНастроекПодключаемыхОбъектов</span> следует
описать простую настройку (например - флажок), которая будет служить маркером
того, что объект расширения поставляет команды данного вида. Например:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ПриОпределенииСоставаНастроекПодключаемыхОбъектов<span class="operator">(</span>НастройкиПрограммногоИнтерфейса<span class="operator">)</span> <span class="keyword">Экспорт</span>
 Настройка <span class="operator">=</span> НастройкиПрограммногоИнтерфейса<span class="operator">.</span>Добавить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
 Настройка<span class="operator">.</span>Ключ <span class="operator">=</span> <span class="string">&quot;&lt;ИмяФлажка&gt;&quot;</span><span class="operator">;</span>
 Настройка<span class="operator">.</span>ОписаниеТипов <span class="operator">=</span> <span class="keyword">Новый</span> ОписаниеТипов<span class="operator">(</span><span class="string">&quot;Булево&quot;</span><span class="operator">)</span><span class="operator">;</span>
 Настройка<span class="operator">.</span>ВидыПодключаемыхОбъектов <span class="operator">=</span> <span class="string">&quot;Обработка&quot;</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoListBullet">&#9679; 
В процедуре <span class="Interface">ПриОпределенииКомандПодключенныхКОбъекту</span> добавить
команды данного вида, которые соответствуют переданному контексту. Например:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ПриОпределенииКомандПодключенныхКОбъекту<span class="operator">(</span>НастройкиФормы<span class="operator">,</span> Источники<span class="operator">,</span> ПодключенныеОтчетыИОбработки<span class="operator">,</span> Команды<span class="operator">)</span> <span class="keyword">Экспорт</span>
    <span class="keyword">Если</span> Источники<span class="operator">.</span>Строки<span class="operator">.</span>Найти<span class="operator">(</span><span class="operator">&lt;</span>ОбъектМетаданных<span class="operator">&gt;</span><span class="operator">,</span> <span class="string">&quot;Метаданные&quot;</span><span class="operator">)</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">Неопределено</span> <span class="keyword">Тогда</span>
        Команда <span class="operator">=</span> Команды<span class="operator">.</span>Добавить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
        Команда<span class="operator">.</span>Вид <span class="operator">=</span> <span class="string">&quot;&lt;ИмяВидаКоманд&gt;&quot;</span><span class="operator">;</span>
        Команда<span class="operator">.</span>Представление <span class="operator">=</span> НСтр<span class="operator">(</span><span class="string">&quot;ru = '&lt;Заголовок команды&gt;'&quot;</span><span class="operator">)</span><span class="operator">;</span>
        Команда<span class="operator">.</span>РежимЗаписи <span class="operator">=</span> <span class="string">&quot;НеЗаписывать&quot;</span><span class="operator">;</span>
        Команда<span class="operator">.</span>ВидимостьВФормах <span class="operator">=</span> <span class="string">&quot;&lt;ИмяФормыОбъекта&gt;&quot;</span><span class="operator">;</span>
        Команда<span class="operator">.</span>Обработчик <span class="operator">=</span> <span class="string">&quot;&lt;МодульПодсистемы&gt;.&lt;ИмяПроцедуры&gt;&quot;</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>		<script type="text/javascript">listenCopy('zeroclipboard.swf');</script>
	</body>
</html>