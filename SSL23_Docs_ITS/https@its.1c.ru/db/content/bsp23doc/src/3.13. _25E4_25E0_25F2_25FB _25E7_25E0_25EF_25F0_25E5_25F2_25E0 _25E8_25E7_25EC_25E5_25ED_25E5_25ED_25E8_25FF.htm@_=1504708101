<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>3.13. &#1044;&#1072;&#1090;&#1099; &#1079;&#1072;&#1087;&#1088;&#1077;&#1090;&#1072; &#1080;&#1079;&#1084;&#1077;&#1085;&#1077;&#1085;&#1080;&#1103;</title>
		<LINK REL="stylesheet" href="style.css@_=1504708101">
		<SCRIPT src="script.js@_=1504708101" TYPE="text/javascript"></script>		<!--[if !IE]>--><SCRIPT src="zeroclipboard.js@_=1504708101" TYPE="text/javascript"></script><!--<![endif]-->
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="3.13. _25E4_25E0_25F2_25FB _25E7_25E0_25EF_25F0_25E5_25F2_25E0 _25E8_25E7_25EC_25E5_25ED_25E5_25ED_25E8_25FF.htm" rel="canonical">
<link href="../../../../static/its.content.css@_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="../../../../static/its.content.js@_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="../../../../static/html5shiv.js@_=1500896273"></script><![endif]-->

</head>
	<body class="bspdoc">
<a name="_даты_запрета_изменени€"></a><h1>3.13. ƒаты запрета изменени€</h1>

<p class="Paragraph0c">ѕодсистема Ђƒаты запрета изменени€ї позвол€ет
заблокировать изменени€ любых данных информационной базы (документов, записей
регистров, элементов справочников и др.) ранее определенной даты. јдминистратор
системы может настроить как одну общую дату дл€ всей информационной базы в
целом, так и несколько дат по разделам и/или отдельным объектам разделов учета.</p>

<p class="Paragraph0c">ѕодсистема всегда предоставл€ет возможность настройки дат
запрета как дл€ всех пользователей, так и дл€ конкретных пользователей, групп
пользователей (опционально Ц дл€ внешних пользователей, групп внешних
пользователей).</p>

<p class="Paragraph0c">»нтерфейс настройки разработан от минимальных возможностей
Ђнет запретаї до максимальных возможностей, определенных при внедрении, но не
более чем <span class="Interface">ѕо разделам и объектам</span> в сочетании с
настройкой <span class="Interface">ѕо пользовател€м</span> (и группам
пользователей).</p>

<p class="Paragraph0c">ѕодсистема позвол€ет устанавливать как произвольные даты
запрета, так и относительные даты запрета (конец прошлого мес€ца, конец
прошлого квартала и другие).</p>

<a name="issogl1_настройка"><h2>Ќастройка</h2></a>

<p class="Number81">1. 
<a href="#_определить_состав_типов,">ќпределить состав типов, дл€ которых будет
выполн€тьс€ запрет изменени€ данных</a>.</p>

<p class="Number81">2. 
<a href="#_определить_состав_типов,_1">ќпределить состав типов, дл€ которых будут
настраиватьс€ запреты загрузки данных</a>.</p>

<p class="Number81">3. 
<a href="#_определить_максимальные_возможности">ќпределить максимальные возможности
настройки дат запрета (обща€ дата, по разделам, по объектам, по разделам и
объектам)</a>.</p>

<p class="Number81">4. 
<a href="#_определить_пол€_объектов">ќпределить пол€ объектов метаданных, которые
будут использованы дл€ получени€ провер€емых данных (даты, раздела, объекта)</a>.</p>

<p class="Number81">5. 
<a href="#_определить_случаи_условного">ќпределить случаи условного отказа от
проверки запрета изменени€ и определить случаи проверки запрета загрузки</a>.</p>

<p class="Number81">6. 
<a href="#_определить_возможность_настройки">ќпределить возможность настройки дат запрета
дл€ внешних пользователей и групп внешних пользователей</a>.</p>

<a name="_определить_состав_типов,"></a><a name="issogl2_определить_состав_типов_дл€_которых_будет_выполн€тьс€_запрет_изменени€_данных"><h3>ќпределить состав типов, дл€ которых будет выполн€тьс€ запрет изменени€ данных</h3></a>

<p class="Paragraph0c">ќпределить состав типов справочников, документов,
регистров, дл€ которых будет выполн€тьс€ запрет изменени€ данных.</p>

<p class="Paragraph0c">—оздать подписки на событи€ и указать в них выбранные типы
согласно таблице, приведенной ниже.</p>

<p class="Paragraph0c">ѕодписки на событие <span class="Interface">ѕеред«аписью</span>
дл€ проверки запрета изменени€ данных:</p>

<p class="Objectname">“аблица 3.23.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">»м€</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">»сточник</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ќбработчик</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ѕроверитьƒату«апрета»зменени€ѕеред«аписьюƒокумента</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Ёлементы типа: <span class="Interface">ƒокументќбъект</span></p>
  </td>
  <td valign="top">
  <a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_res">ƒаты«апрета»зменени€.ѕроверитьƒату«апрета»зменени€ѕеред«аписьюƒокумента</pre>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ѕроверитьƒату«апрета»зменени€ѕеред«аписью</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Ёлементы типов: <span class="Interface">—правочникќбъект</span>,
  <span class="Interface">ѕлан¬идов’арактеристикќбъект</span>, <span class="Interface">ѕлан—четовќбъект</span>, <span class="Interface">ѕлан¬идов–асчетаќбъект</span>,
  <span class="Interface">Ѕизнесѕроцессќбъект</span>, <span class="Interface">«адачаќбъект</span>,
  <span class="Interface">ѕланќбменаќбъект</span></p>
  </td>
  <td valign="top">
  <a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_res">ƒаты«апрета»зменени€. ѕроверитьƒату«апрета»зменени€ѕеред«аписью</pre>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ѕроверитьƒату«апрета»зменени€ѕеред«аписьюЌабора«аписей</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Ёлементы типов: <span class="Interface">–егистр—веденийЌабор«аписей</span>, <span class="Interface">–егистрЌакоплени€Ќабор«аписей</span></p>
  </td>
  <td valign="top">
  <a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_res">ƒаты«апрета»зменени€. ѕроверитьƒату«апрета»зменени€ѕеред«аписьюЌабора«аписей</pre>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ѕроверитьƒату«апрета»зменени€ѕеред«аписьюЌабора«аписей–егистраЅухгалтерии</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Ёлементы типа: <span class="Interface">–егистрЅухгалтерииЌабор«аписей</span></p>
  </td>
  <td valign="top">
  <a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_res">ƒаты«апрета»зменени€. ѕроверитьƒату«апрета»зменени€ѕеред«аписьюЌабора«аписей–егистраЅухгалтерии</pre>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ѕроверитьƒату«апрета»зменени€ѕеред«аписьюЌабора«аписей–егистра–асчета</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Ёлементы типа: <span class="Interface">–егистр–асчетаЌабор«аписей</span></p>
  </td>
  <td valign="top">
  <a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_res">ƒаты«апрета»зменени€. ѕроверитьƒату«апрета»зменени€ѕеред«аписьюЌабора«аписей–егистра–асчета</pre>
  </td>
 </tr>
</table>

<p class="Paragraph0c">ѕодписки на событие <span class="Interface">ѕеред”далением</span>
дл€ проверки запрета изменени€ данных:</p>

<p class="Objectname">“аблица 3.24.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">»м€</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">»сточник</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ќбработчик</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ѕроверитьƒату«апрета»зменени€ѕеред”далением</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Ёлементы типа: <span class="Interface">—правочникќбъект</span>,
  <span class="Interface">ƒокументќбъект</span>, <span class="Interface">ѕлан¬идов’арактеристикќбъект</span>,
  <span class="Interface">ѕлан—четовќбъект</span>, <span class="Interface">ѕлан¬идов–асчетаќбъект</span>,
  <span class="Interface">Ѕизнесѕроцессќбъект</span>, <span class="Interface">«адачаќбъект</span>,
  <span class="Interface">ѕланќбменаќбъект</span></p>
  </td>
  <td valign="top">
  <a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_res">ƒаты«апрета»зменени€. ѕроверитьƒату«апрета»зменени€ѕеред”далением</pre>
  </td>
 </tr>
</table>

<p class="Paragraph0c">ƒл€ выбранных объектов метаданных необходимо вставить в
модуль формы объекта в процедуру обработчика событи€ <span class="Interface">ѕри„тенииЌа—ервере</span>
вызов:</p>

<a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_dev">ƒаты«апрета»зменени€<span class="operator">.</span>ќбъектѕри„тенииЌа—ервере<span class="operator">(</span>Ётотќбъект<span class="operator">,</span> “екущийќбъект<span class="operator">)</span><span class="operator">.</span></pre>

<p class="Paragraph0c">ѕри выполнении вызова будет выполнена проверка запрета
изменени€, и при наличии запрета свойство формы <span class="Interface">“олькоѕросмотр</span>
будет установлено <span class="Interface">»стина</span>. </p>

<a name="_определить_состав_типов,_1"></a><a name="issogl2_определить_состав_типов_дл€_которых_будут_настраиватьс€_запреты_загрузки_данных"><h3>ќпределить состав типов, дл€ которых будут настраиватьс€ запреты загрузки данных</h3></a>

<p class="Paragraph0c">ƒл€ запрета загрузки данных по узлам планов обмена
необходимо в определ€емый тип <span class="Interface">јдресат«апрета»зменени€</span>
добавить типы требуемых планов обмена. ≈сли хот€ бы один тип плана обмена
добавлен в состав определ€емого типа <span class="Interface">јдресат«апрета»зменени€</span>,
то по команде <span class="Interface">ƒаты запрета загрузки</span> данных будет
открыта форма <span class="Interface">ƒаты запрета изменени€ данных</span> в режиме
редактировани€ дат запрета загрузки.</p>

<a name="_определить_максимальные_возможности"></a><a name="issogl2_определить_максимальные_возможности_настройки_дат_запрета_обща€_дата_по_разделам_по_объектам_по_разделам_и_объектам"><h3>ќпределить максимальные возможности настройки дат запрета (обща€ дата, по разделам, по объектам, по разделам и объектам)</h3></a>

<p class="Paragraph0c">ƒл€ различных прикладных решений требовани€ к настройке
даты запрета сильно отличаютс€. ƒл€ простой однопользовательской конфигурации
достаточно одной общей даты, а дл€ корпоративного решени€ требуетс€ множество
разрезов дат запрета к различным област€м планировани€ и учета. ƒл€ этих целей
предусмотрены разделы Ц это разрезы областей планировани€ и учета дл€ установки
дат запрета. Ќапример, <span class="Interface">—кладской учет</span>, <span class="Interface">Ѕухгалтерска€ отчетность</span>, <span class="Interface">ѕланирование</span>.
¬ подсистеме разделы Ц это предопределенные элементы объекта метаданных <span class="Interface">ѕлан¬идов’арактеристик.–азделыƒат«апрета»зменени€</span>,
которые редактируютс€ в конфигураторе, а в режиме <span class="Interface">1—:ѕредпри€тие</span>
не редактируютс€.</p>

<p class="Paragraph0c">ѕри необходимости разделы могут быть уточнены объектом Ц например,
раздел <span class="Interface">—кладской учет</span> можно уточнить складом. ƒл€
этого разделу нужно установить тип, например <span class="Interface">—правочник—сылка.—клады</span>.
≈сли раздел не предполагаетс€ уточн€ть объектом, тогда нужно установить тип <span class="Interface">ѕлан¬идов’арактеристик—сылка.–азделыƒат«апрета»зменени€</span>.</p>

<p class="Paragraph0c">¬озможны четыре варианта внедрени€:</p>

<p class="Number81">1. 
<span class="Interface">ќбща€ дата</span>. ¬ этом
варианте список разделов пуст, у пользовател€ будет возможность задавать общую
дату на всю конфигурацию (дл€ всех пользователей или по пользовател€м).</p>

<p class="Number81">2. 
<span class="Interface">ѕо разделам</span>. ¬ этом
варианте список разделов состоит из двух и более разделов, типы разделов не
определены (<span class="Interface">ѕлан¬идов’арактеристик—сылка.–азделыƒат«апрета»зменени€</span>).
¬ интерфейсе объекты не отображаютс€, их нельз€ добавить. Ќапример, разделы <span class="Interface">”чет</span> и <span class="Interface">ѕланирование</span>. ѕри
этом можно задать общую дату или две даты отдельно по каждому разделу.</p>

<p class="Number81">3. 
<span class="Interface">ѕо объектам</span>. ¬ этом
варианте список разделов состоит из одного раздела. Ётот раздел не отображаетс€
в интерфейсе, но используетс€ при получении данных дл€ проверки. ” раздела
задан непустой тип. Ќапример, раздел <span class="Interface">Ѕухгалтерский учет</span>
с типом <span class="Interface">—правочник—сылка.ќрганизации</span>. ѕри этом
можно задать общую дату или даты по отдельным организаци€м.</p>

<p class="Number81">4. 
<span class="Interface">ѕо разделам и объектам</span>.
¬ этом самом общем варианте список разделов состоит из двух и более разделов,
причем хот€ бы один раздел должен иметь определенный тип. Ќапример, <span class="Interface">”чет по организаци€м</span> и <span class="Interface">ѕланирование</span>.</p>

<a name="_определить_пол€_объектов"></a><a name="issogl2_определить_пол€_объектов_метаданных_которые_будут_использованы_дл€_получени€_провер€емых_данных_даты_раздела_объекта"><h3>ќпределить пол€ объектов метаданных, которые будут использованы дл€ получени€ провер€емых данных (даты, раздела, объекта)</h3></a>

<p class="Paragraph0c">ƒл€ подготовки данных к проверке на запрет изменени€
требуетс€ дл€ каждого из выбранных объектов метаданных определить пол€ Ц источники
значений. ƒл€ этих целей используетс€ процедура <span class="Interface">«аполнить»сточникиƒанныхƒл€ѕроверки«апрета»зменени€</span>
переопредел€емого модул€.</p>

<a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// —одержит описание таблиц и полей объектов дл€ проверки запретов изменени€ данных.</span>
<span class="comment">//†† ¬ызываетс€ из процедуры »зменение«апрещено общего модул€ ƒаты«апрета»зменени€,</span>
<span class="comment">//†† используемой в подписке на событие ѕеред«аписью объекта дл€ проверки наличи€</span>
<span class="comment">//†† запретов и отказа от изменений запрещенного объекта.</span>
<span class="comment">//</span>
<span class="comment">// ѕараметры:</span>
<span class="comment">//† »сточникиƒанных - “аблица«начений - с колонками:</span>
<span class="comment">//†† * “аблица†††† - —трока - полное им€ объекта метаданных,</span>
<span class="comment">//†††††††††††††††††† например ћетаданные.ƒокументы.ѕриходна€Ќакладна€.ѕолное»м€().</span>
<span class="comment">//†† * ѕолеƒаты††† - —трока - им€ реквизита объекта или табличной части,</span>
<span class="comment">//†††††††††††††††††† например, &quot;ƒата&quot;, &quot;“овары.ƒатаќтгрузки&quot;.</span>
<span class="comment">//†† * –аздел††††† - —трока - им€ предопределенного элемента</span>
<span class="comment">//†††††††††††††††††† &quot;ѕлан¬идов’арактеристик—сылка.–азделыƒат«апрета&quot;.</span>
<span class="comment">//†† * ѕолеќбъекта - —трока - им€ реквизита объекта или реквизита табличной части,</span>
<span class="comment">//†††††††††††††††††† например, &quot;ќрганизаци€&quot;, &quot;“овары.—клад&quot;.</span>
<span class="comment">//</span>
<span class="comment">//† ƒл€ добавлени€ строки имеетс€ процедура ƒобавить—троку в общем модуле ƒаты«апрета»зменени€.</span>
<span class="comment">//</span>
<span class="keyword">ѕроцедура</span> «аполнить»сточникиƒанныхƒл€ѕроверки«апрета»зменени€<span class="operator">(</span>»сточникиƒанных<span class="operator">)</span> <span class="keyword">Ёкспорт</span>
    ƒаты«апрета»зменени€<span class="operator">.</span>ƒобавить—троку<span class="operator">(</span>»сточникиƒанных<span class="operator">,</span>
        ћетаданные<span class="operator">.</span>ƒокументы<span class="operator">.</span>_ƒемоќприходование“оваров<span class="operator">.</span>ѕолное»м€<span class="operator">(</span><span class="operator">)</span><span class="operator">,</span>
        <span class="string">&quot;ƒата&quot;</span><span class="operator">,</span> <span class="string">&quot;_ƒемо—кладской”чет&quot;</span><span class="operator">,</span> <span class="string">&quot;ћесто’ранени€&quot;</span><span class="operator">)</span><span class="operator">;</span>
    ƒаты«апрета»зменени€<span class="operator">.</span>ƒобавить—троку<span class="operator">(</span>»сточникиƒанных<span class="operator">,</span>
        ћетаданные<span class="operator">.</span>ƒокументы<span class="operator">.</span>_ƒемо—писание“оваров<span class="operator">.</span>ѕолное»м€<span class="operator">(</span><span class="operator">)</span><span class="operator">,</span>
        <span class="string">&quot;ƒата&quot;</span><span class="operator">,</span> <span class="string">&quot;_ƒемо—кладской”чет&quot;</span><span class="operator">,</span> <span class="string">&quot;ћесто’ранени€&quot;</span><span class="operator">)</span><span class="operator">;</span>
    ƒаты«апрета»зменени€<span class="operator">.</span>ƒобавить—троку<span class="operator">(</span>»сточникиƒанных<span class="operator">,</span>
        ћетаданные<span class="operator">.</span>ƒокументы<span class="operator">.</span>_ƒемо—писаниеЅезналичныхƒенежных—редств<span class="operator">.</span>ѕолное»м€<span class="operator">(</span><span class="operator">)</span><span class="operator">,</span>
        <span class="string">&quot;ƒатаѕроведени€Ѕанком&quot;</span><span class="operator">,</span> <span class="string">&quot;_ƒемоЅанк&quot;</span><span class="operator">,</span> <span class="string">&quot;Ѕанковский—чет&quot;</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword"> онецѕроцедуры</span></pre>

<p class="Paragraph0c">ѕоле может быть задано Ђчерез точкуї, например, если в
документе указана ссылка на документ-основание, содержащий объект. “огда
реквизит будет задан так: <span class="Interface">ƒокументќснование.—клад</span>,
где <span class="Interface">ƒокументќснование</span> Ц реквизит документа,
провер€емого на запрет изменени€. ћожно указать поле Ђчерез несколько точекї.</p>

<p class="Paragraph0c">¬ качестве пол€ можно указать поле табличной части, в этом
случае используетс€ тот же метод Ђчерез точкуї, например <span class="Interface">“овары.—клад</span>.
”казывать поле табличной части можно только в провер€емом документе, а не в
документе-основании (такое описание не поддерживаетс€).</p>

<p class="Paragraph0c">—ледует иметь в виду, что использование метода Ђчерез
точкуї потребует дополнительного обращени€ к базе данных дл€ получени€
значени€, а использование пол€ табличной части увеличит количество провер€емых
данных.</p>

<p class="Paragraph0c">ƒл€ объекта данных может потребоватьс€ несколько проверок (например,
дл€ документа <span class="Interface">ѕеремещение“оваров</span> требуетс€
проверить запрет изменени€ по двум складам). ¬ этом случае используютс€ несколько
строк дл€ описани€ проверок по одному объекту метаданных (см. пример выше).</p>

<a name="_определить_случаи_условного"></a><a name="issogl2_определить_случаи_условного_отказа_от_проверки_запрета_изменени€_и_определить_случаи_проверки_запрета_загрузки"><h3>ќпределить случаи условного отказа от проверки запрета изменени€ и определить случаи проверки запрета загрузки</h3></a>

<p class="Paragraph0c"> роме стандартного случа€ отказа от проверки запрета
изменени€ и запрета загрузки данных при обновлении информационной базы,
прикладной разработчик может пропустить проверку запретов по прикладным причинам.</p>

<p class="Paragraph0c">≈сли в прикладной конфигурации потребовалось пропустить
проверку запрета изменени€ данных, например, если заказ не закрыт (или при
особых случа€х обмена данными пропустить проверку запрета загрузки данных) следует
воспользоватьс€ переопредел€емой процедурой <span class="Interface">ѕередѕроверкой«апрета»зменени€</span>.</p>

<a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// ѕозвол€ет переопределить выполнение проверок запретов по произвольному условию.</span>
<span class="comment">//</span>
<span class="comment">// ѕараметры:</span>
<span class="comment">//† ќбъект†††††† - —правочникќбъект,</span>
<span class="comment">//†††††††††††††††† ƒокументќбъект,</span>
<span class="comment">//†††††††††††††††† ѕлан¬идов’арактеристикќбъект,</span>
<span class="comment">//†††††††††††††††† ѕлан—четовќбъект,</span>
<span class="comment">//†††††††††††††††† ѕлан¬идов–асчетаќбъект,</span>
<span class="comment">//†††††††††††††††† Ѕизнесѕроцессќбъект,</span>
<span class="comment">//†††††††††††††††† «адачаќбъект,</span>
<span class="comment">//†††††††††††††††† ѕланќбменаќбъект - объект данных (ѕеред«аписью или ѕри„тенииЌа—ервере).</span>
<span class="comment">//††††††† †††††††- –егистр—веденийЌабор«аписей,</span>
<span class="comment">//†††††††††††††††† –егистрЌакоплени€Ќабор«аписей,</span>
<span class="comment">//†††††††††††††††† –егистрЅухгалтерииЌабор«аписей,</span>
<span class="comment">//†††††††††††††††† –егистр–асчетаЌабор«аписей - набор записей (ѕеред«аписью или ѕри„тенииЌа—ервере).</span>
<span class="comment">//† </span>
<span class="comment">//† ѕроверка«апрета»зменени€††† - Ѕулево - когда »стина, тогда проверка изменени€ выполн€етс€.</span>
<span class="comment">//††††††††††††††††††††††††††††††† ≈сли установить Ћожь, тогда проверка запрета изменени€ будет пропущена.</span>
<span class="comment">//</span>
<span class="comment">//† ”зелѕроверки«апрета«агрузки - Ќеопределено - проверка запрета загрузки не выполн€етс€.</span>
<span class="comment">//††††††††††††††††††††††††††††† - ѕланыќбмена—сылка - проверка запрета загрузки выполн€етс€. ≈сли</span>
<span class="comment">//††††††††††††††††††††††††††††††† установить Ќеопределено, проверка запрета загрузки будет пропущена.</span>
<span class="comment">//</span>
<span class="comment">//† ¬ерси€ќбъекта††††††† †††††††- —трока - начальное значение &quot;&quot;. ѕровер€ютс€ обе версии объекта.</span>
<span class="comment">//††††††††††††††††††††††††††††††† ≈сли установить &quot;—тара€¬ерси€&quot; или &quot;Ќова€¬ерси€&quot;, тогда будет</span>
<span class="comment">//††††††††††††††††††††††††††††††† выполнена проверка только старой или только новой версии объекта.</span>
<span class="comment">//</span>
<span class="keyword">ѕроцедура</span> ѕередѕроверкой«апрета»зменени€<span class="operator">(</span>ќбъект<span class="operator">,</span>
†††††††††††††††††††††††††††††††††††††††† ѕроверка«апрета»зменени€<span class="operator">,</span>
†††††††††††††††††††††††††††††††††††††††† ”зелѕроверки«апрета«агрузки<span class="operator">,</span>
†††††††††††††††††††††††††††††††††††††††† ¬ерси€ќбъекта<span class="operator">)</span> <span class="keyword">Ёкспорт</span>
    <span class="keyword">≈сли</span> “ип«нч<span class="operator">(</span>ќбъект<span class="operator">)</span> <span class="operator">=</span> “ип<span class="operator">(</span><span class="string">&quot;ƒокументќбъект._ƒемо«аказѕокупател€&quot;</span><span class="operator">)</span> <span class="keyword">“огда</span>
        —татус«аказа <span class="operator">=</span> ќбщегоЌазначени€<span class="operator">.</span>«начение–еквизитаќбъекта<span class="operator">(</span>ќбъект<span class="operator">.</span>—сылка<span class="operator">,</span> <span class="string">&quot;—татус«аказа&quot;</span><span class="operator">)</span><span class="operator">;</span>
        «аказ«акрыт—тара€¬ерси€ <span class="operator">=</span> <span class="operator">(</span>—татус«аказа††††††† <span class="operator">=</span> ѕеречислени€<span class="operator">.</span>_ƒемо—татусы«аказовѕокупателей<span class="operator">.</span>«акрыт<span class="operator">)</span><span class="operator">;</span>
        «аказ«акрытЌова€¬ерси€† <span class="operator">=</span> <span class="operator">(</span>ќбъект<span class="operator">.</span>—татус«аказа <span class="operator">=</span> ѕеречислени€<span class="operator">.</span>_ƒемо—татусы«аказовѕокупателей<span class="operator">.</span>«акрыт<span class="operator">)</span><span class="operator">;</span>
        <span class="keyword">≈сли</span> <span class="keyword">Ќе</span> «аказ«акрыт—тара€¬ерси€ <span class="keyword">»</span> <span class="keyword">Ќе</span> «аказ«акрытЌова€¬ерси€ <span class="keyword">“огда</span>
            ѕроверка«апрета»зменени€ <span class="operator">=</span> <span class="keyword">Ћожь</span><span class="operator">;</span>
            ”зелѕроверки«апрета«агрузки <span class="operator">=</span> <span class="keyword">Ќеопределено</span><span class="operator">;</span>
        <span class="keyword">»наче≈сли</span> <span class="keyword">Ќе</span> «аказ«акрытЌова€¬ерси€ <span class="keyword">“огда</span>
            ¬ерси€ќбъекта <span class="operator">=</span> <span class="string">&quot;—тара€¬ерси€&quot;</span><span class="operator">;</span> <span class="comment">// ѕроверить только старую версию объекта.</span>
        <span class="keyword">»наче≈сли</span> <span class="keyword">Ќе</span> «аказ«акрыт—тара€¬ерси€ <span class="keyword">“огда</span>
            ¬ерси€ќбъекта <span class="operator">=</span> <span class="string">&quot;Ќова€¬ерси€&quot;</span><span class="operator">;</span> <span class="comment">// ѕроверить только новую версию объекта.</span>
        <span class="keyword"> онец≈сли</span><span class="operator">;</span>
    <span class="keyword">»наче≈сли</span> “ип«нч<span class="operator">(</span>ќбъект<span class="operator">)</span> <span class="operator">=</span> “ип<span class="operator">(</span><span class="string">&quot;ƒокументќбъект._ƒемо—писаниеЅезналичныхƒенежных—редств&quot;</span><span class="operator">)</span> <span class="keyword">“огда</span>
        <span class="comment">// ќтказ от проверки с учетом того, что ƒатаѕроведени€Ѕанком, используема€ в проверке не указываетс€,</span>
        <span class="comment">// если документ не проведен банком, а указываетс€ позже после проведени€ документа банком.</span>
        ѕроведеноЅанкомЌова€¬ерси€† <span class="operator">=</span> ќбъект<span class="operator">.</span>ѕроведеноЅанком<span class="operator">;</span>
        ѕроведеноЅанком—тара€¬ерси€ <span class="operator">=</span> ќбщегоЌазначени€<span class="operator">.</span>«начение–еквизитаќбъекта<span class="operator">(</span>
            ќбъект<span class="operator">.</span>—сылка<span class="operator">,</span> <span class="string">&quot;ѕроведеноЅанком&quot;</span><span class="operator">)</span> <span class="operator">=</span> <span class="keyword">»стина</span><span class="operator">;</span>
        <span class="keyword">≈сли</span> <span class="keyword">Ќе</span> ѕроведеноЅанкомЌова€¬ерси€ <span class="keyword">»</span> <span class="keyword">Ќе</span> ѕроведеноЅанком—тара€¬ерси€ <span class="keyword">“огда</span>
            ѕроверка«апрета»зменени€ <span class="operator">=</span> <span class="keyword">Ћожь</span><span class="operator">;</span>
            ”зелѕроверки«апрета«агрузки <span class="operator">=</span> <span class="keyword">Ќеопределено</span><span class="operator">;</span>
        <span class="keyword">»наче≈сли</span> <span class="keyword">Ќе</span> ѕроведеноЅанкомЌова€¬ерси€ <span class="keyword">“огда</span>
            ¬ерси€ќбъекта <span class="operator">=</span> <span class="string">&quot;—тара€¬ерси€&quot;</span><span class="operator">;</span> <span class="comment">// ѕроверить только старую версию объекта.</span>
        <span class="keyword">»наче≈сли</span> <span class="keyword">Ќе</span> ѕроведеноЅанком—тара€¬ерси€ <span class="keyword">“огда</span>
            ¬ерси€ќбъекта <span class="operator">=</span> <span class="string">&quot;Ќова€¬ерси€&quot;</span><span class="operator">;</span> <span class="comment">// ѕроверить только новую версию объекта.</span>
        <span class="keyword"> онец≈сли</span><span class="operator">;</span>
    <span class="keyword"> онец≈сли</span><span class="operator">;</span>
<span class="keyword"> онецѕроцедуры</span></pre>

<a name="_определить_возможность_настройки"></a><a name="issogl2_определить_возможность_настройки_дат_запрета_дл€_внешних_пользователей_и_групп_внешних_пользователей"><h3>ќпределить возможность настройки дат запрета дл€ внешних пользователей и групп внешних пользователей</h3></a>

<p class="Paragraph0c">≈сли в прикладном решении требуетс€ делать настройку по
внешним пользовател€м и группам внешних пользователей, то нужно вписать код в
процедуру <span class="Interface">Ќастройка»нтерфейса</span> переопредел€емого
модул€:</p>

<a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ѕроцедура</span> Ќастройка»нтерфейса<span class="operator">(</span><span class="keyword">«нач</span> Ќастройки–аботы»нтерфейса<span class="operator">)</span> <span class="keyword">Ёкспорт</span>
    Ќастройки–аботы»нтерфейса<span class="operator">.</span>»спользовать¬нешнихѕользователей <span class="operator">=</span> <span class="keyword">»стина</span><span class="operator">;</span>
<span class="keyword"> онецѕроцедуры</span></pre>

<a name="issogl2_размещение_в_командном_интерфейсе"><h3>–азмещение в командном интерфейсе</h3></a>

<p class="Paragraph0c">ƒл€ использовани€ подсистемы необходимо разместить в
командном интерфейсе ответственного за даты запрета объекты метаданных: </p>

<p class="MsoListBullet">&#9679; 
команду <span class="Interface">ƒаты«апрета»зменени€ƒанных</span>
Ц дл€ просмотра и редактировани€ дат запрета изменени€;</p>

<p class="MsoListBullet">&#9679; 
команду <span class="Interface">ƒаты«апрета«агрузкиƒанных</span>
Ц дл€ просмотра и редактировани€ дат запрета загрузки (если запреты загрузки не
используютс€, команду размещать не требуетс€).</p>

<p class="Paragraph0c">ƒл€ размещени€ команд требуетс€ включить регистр сведений <span class="Interface">ƒаты«апрета»зменени€</span> в подсистему интерфейса (у регистра
отключено использование стандартных команд).</p>

<a name="issogl2_настройка_прав_доступа_пользователей"><h3>Ќастройка прав доступа пользователей</h3></a>

<p class="Paragraph0c">ƒл€ настройки прав доступа пользователей к данным
подсистемы Ђƒаты запрета изменени€ї следует использовать роли:</p>

<p class="Objectname">“аблица 3.25.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">є</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">–оли и их назначение</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="TextinTable81">1.</p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ѕолныеѕрава</span> (из подсистемы ЂЅазова€
  функциональностьї)</p>
  <p class="TextinTable81">ѕросмотр и
  редактирование дат запрета изменени€ и дат запрета загрузки (доступ к форме <span class="Interface">ƒаты запрета изменени€ данных</span> с отчетами)</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81">2.</p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ƒобавление изменение дат запрета
  изменени€</span></p>
  <p class="TextinTable81">ѕросмотр и редактирование дат запрета изменени€
  (доступ к форме <span class="Interface">ƒаты запрета изменени€ данных</span> и
  отчету <span class="Interface">ƒаты запрета изменени€ данных</span>)</p>
  </td>
 </tr>
</table>

<a name="issogl1_использование_при_разработке_конфигурации"><h2>»спользование при разработке конфигурации</h2></a>

<p class="Paragraph0c">ѕри создании новых прикладных объектов метаданных нужно
повторно выполн€ть соответствующую часть процедуры настройки, описанной выше.</p>

<p class="Paragraph0c">ƒл€ дополнительной проверки запрета изменени€ (вне
подписок на событи€) используетс€ функци€ <span class="Interface">»зменение«апрещено</span>
модул€ <span class="Interface">ƒаты«апрета»зменени€</span>.</p>

<p class="Paragraph0c">“акже может потребоватьс€ выполнить программную проверку
запрета изменени€ нестандартного вида. ƒл€ этого предусмотрена функци€ <span class="Interface">Ќайден«апрет»зменени€ƒанных</span> модул€ <span class="Interface">ƒаты«апрета»зменени€</span>, котора€ выполнит проверку и вернет
ее результат, а также отправит стандартное сообщение пользователю об ошибке.</p>

<p class="Paragraph0c">ƒл€ работы функции нужно подготовить данные, шаблон
которых легко получить (см. комментарий функции). Ёта функци€ используетс€ в
подписке на событие перед записью. ƒанные, полученные из объекта данных,
передаютс€ в функцию дважды Ц дл€ старого и нового экземпл€ров объекта.</p>

<a class="copy_source" href="#_top" onClick="return false"> опировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// ¬ыполн€ет поиск дат запрета по провер€емым данным</span>
<span class="comment">// дл€ авторизованного пользовател€ или узла плана обмена.</span>
<span class="comment">//</span>
<span class="comment">// ѕараметры:</span>
<span class="comment">//† ƒанныеƒл€ѕроверки - “аблица«начений - возвращаетс€ функцией Ўаблонƒанныхƒл€ѕроверки</span>
<span class="comment">//††††††††††††††††††††† общего модул€ ƒаты«апрета»зменени€.</span>
<span class="comment">//</span>
<span class="comment">//† ќписаниеƒанных††† - Ќеопределено - текст сообщени€ о запрете не формируетс€.</span>
<span class="comment">//††††††††††††††††††† - —труктура - со свойствами:</span>
<span class="comment">//††††††††††††††††††††† * Ќова€¬ерси€ - Ѕулево - если »стина, то сообщение о запрете</span>
<span class="comment">//†††††††††††††††††††††††††††††††††† формировать дл€ новой версии, иначе дл€ старой версии.</span>
<span class="comment">//††††††††††††††††††† ††* ƒанные - —сылка,ќбъект - ссылка или объект данных дл€ получени€</span>
<span class="comment">//†††††††††††††††††††††††††††††††††† представлени€, которое будет использовано в сообщении о запрете.</span>
<span class="comment">//†††††††††††††††††††††††††††††† - Ќабор«аписей - набор записей регистра дл€ получени€</span>
<span class="comment">//†††††††††††††††††††††††††††††††††† представлени€, которое будет использовано в сообщении о запрете.</span>
<span class="comment">//†††††††††††††††††††††††††††††† - —труктура - со свойствами дл€ сообщени€ о запрете:</span>
<span class="comment">//†††††††††††††††††††††††††††††††††† * –егистр - —трока - полное им€ регистра;</span>
<span class="comment">//†††††††††††††††††††††††††††††††††† * ќтбор†† - ќтбор - отбор набора записей.</span>
<span class="comment">//†††††††††††††††††††††††††††††† - —трока - подготовленное представление данных,</span>
<span class="comment">//†††††††††††††††††††††††††††††††† которое будет использовано в сообщении о запрете.</span>
<span class="comment">//</span>
<span class="comment">//† ќписаниеќшибки††† - —трока - (возвращаемое значение) описание запрета изменени€ или загрузки.</span>
<span class="comment">//††††††††††††††††††††† Ќе заполн€етс€, если параметр ќписаниеƒанных не указан.</span>
<span class="comment">//††††††††††††††††††† - Null - в этом случае текст сообщени€ об ошибке не будет подготовлен,</span>
<span class="comment">//††††††††††††††††††††† что ускор€ет выполнение проверки, когда запрет найден.</span>
<span class="comment">//</span>
<span class="comment">//† ”зелѕроверки«апрета«агрузки - Ќеопределено - выполнить проверку изменени€ данных.</span>
<span class="comment">//††††††††††††††††††††††††††††† - ѕланыќбмена—сылка.&lt;»м€ плана обмена&gt; - выполнить проверку</span>
<span class="comment">//††††††††††††††††††††††††††††††† загрузки данных дл€ указанного узла.</span>
<span class="comment">//</span>
<span class="comment">// ¬озвращаемое значение:</span>
<span class="comment">//† Ѕулево - если »стина, значит найден хот€ бы один запрет изменени€.</span>
<span class="comment">//</span>
<span class="keyword">‘ункци€</span> Ќайден«апрет»зменени€ƒанных<span class="operator">(</span><span class="keyword">«нач</span> ƒанныеƒл€ѕроверки<span class="operator">,</span>
††††††††††††††††††††††††††††††††††† ќписаниеƒанных <span class="operator">=</span> <span class="keyword">Ќеопределено</span><span class="operator">,</span>
††††††††††††††††††††††††††††††††††† ќписаниеќшибки <span class="operator">=</span> <span class="keyword">Null</span><span class="operator">,</span>
††††††††††††††††††††††††††††††††††† ”зелѕроверки«апрета«агрузки <span class="operator">=</span> <span class="keyword">Ќеопределено</span><span class="operator">)</span> <span class="keyword">Ёкспорт</span> </pre>

<a name="issogl2_взаимодействие_при_обмене_данными"><h3>¬заимодействие при обмене данными</h3></a>

<p class="Paragraph0c">ƒл€ проверки запрета загрузки следует использовать функцию
<span class="Interface">«агрузка«апрещена</span> модул€ <span class="Interface">ƒаты«апрета»зменени€</span>.</p>

<p class="Paragraph0c">≈сли при обмене данными требуетс€ выполнить запись, когда
признак <span class="Interface">ќбменƒанными.«агрузка</span> не установлен, но
без проверки запрета изменени€, то в свойства объекта <span class="Interface">ƒополнительные—войства</span>
нужно вставить свойство <span class="Interface">ѕропуститьѕроверку«апрета»зменени€</span>.</p>

<a name="issogl2_настройка_обмена_данными"><h3>Ќастройка обмена данными</h3></a>

<p class="Paragraph0c">ƒл€ настройки обмена данными следует руководствоватьс€
общими правилами.</p>

<p class="Paragraph0c">¬ планы обмена распределенной информационной базы (–»Ѕ)
рекомендуетс€ включать все объекты метаданных подсистемы, кроме константы <span class="Interface">¬ерси€ƒат«апрета»зменени€</span>.</p>

<p class="Paragraph0c">»з остальных планов обмена (не –»Ѕ) рекомендуетс€
исключать все объекты метаданных подсистемы.</p>		<script type="text/javascript">listenCopy('zeroclipboard.swf');</script>
	</body>
</html>