<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>&#1047;&#1072;&#1084;&#1077;&#1085;&#1080;&#1090;&#1100;&#1057;&#1089;&#1099;&#1083;&#1082;&#1080;</title>
		<LINK REL="stylesheet" href="style.css@_=1504708101">
		<SCRIPT src="script.js@_=1504708101" TYPE="text/javascript"></script>
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="_25E7_25E0_25EC_25E5_25ED_25E8_25F2_25FC_25F1_25F1_25FB_25EB_25EA_25E8.htm" rel="canonical">
<link href="../../../../static/its.content.css@_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="../../../../static/its.content.js@_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="../../../../static/html5shiv.js@_=1500896273"></script><![endif]-->

</head>
	<body class="bspdoc">
<a name="_общегоназначениязаменитьссылки"></a><h1>ЗаменитьСсылки</h1>

<pre> Производит замену ссылок во всех данных. После замены неиспользуемые ссылки опционально удаляются.
 Замена ссылок происходит с транзакциями по изменяемому объекту и его связям, не по анализируемой ссылке.</pre>
<p class="Paragraph0c"><span class="Bold">Синтаксис</span></p>
<pre> Функция ЗаменитьСсылки(Знач ПарыЗамен, Знач Параметры = Неопределено) Экспорт</pre>
<p class="Paragraph0c"><span class="Bold">Параметры</span></p>
<pre>   ПарыЗамен - Соответствие - Пары замен.
       * Ключ     - ЛюбаяСсылка - Что ищем (дубль).
       * Значение - ЛюбаяСсылка - На что заменяем (оригинал).
       Ссылки сами на себя и пустые ссылки для поиска будут проигнорированы.
   Параметры - Структура - Необязательный. Параметры замены.
       * СпособУдаления - Строка - Необязательный. Что делать с дублем после успешной замены.
           ""                - По умолчанию. Не предпринимать никаких действий.
           "Пометка"         - Помечать на удаление.
           "Непосредственно" - Удалять непосредственно.
       * УчитыватьПрикладныеПравила - Булево - Необязательный. Режим проверки параметра ПарыЗамен.
           Истина - По умолчанию. Проверять каждую пару "дубль-оригинал" (вызывается функция ВозможностьЗаменыЭлементов модуля менеджера).
           Ложь   - Отключить прикладные проверки пар.
       * ВключатьБизнесЛогику - Булево - Необязательный. Режим записи мест использования при замене дублей на оригиналы.
           Истина - По умолчанию. Места использования дублей записываются в режиме ОбменДанными.Загрузка = Ложь.
           Ложь   - Запись ведется в режиме ОбменДанными.Загрузка = Истина.
       * ЗаменаПарыВТранзакции - Булево - Необязательный. Определяет размер транзакции.
           Истина - По умолчанию. Транзакция охватывает все места использования одного дубля. Может быть очень ресурсоемко 
                    в случае большого количества мест использований.
           Ложь   - Замена каждого места использования выполняется в отдельной транзакции.
       * ПривилегированнаяЗапись - Булево - Необязательный. Требуется ли устанавливать привилегированный режим перед запись.
           Ложь   - По умолчанию. Записывать с текущими правами.
           Истина - Записывать в привилегированном режиме.</pre>
<p class="Paragraph0c"><span class="Bold">Возвращаемое значение</span></p>
<pre>   ТаблицаЗначений - Неуспешные замены (ошибки).
       * Ссылка - ЛюбаяСсылка - Ссылка, которую заменяли.
       * ОбъектОшибки - Произвольный - Объект - причина ошибки.
       * ПредставлениеОбъектаОшибки - Строка - Строковое представление объекта ошибки.
       * ТипОшибки - Строка - Тип ошибки:
           "ОшибкаБлокировки"  - при обработке ссылки некоторые объекты были заблокированы.
           "ДанныеИзменены"    - в процессе обработки данные были изменены другим пользователем.
           "ОшибкаЗаписи"      - не смогли записать объект, или метод ВозможностьЗаменыЭлементов вернул отказ.
           "ОшибкаУдаления"    - не смогли удалить объект.
           "НеизвестныеДанные" - при обработке были найдены данные, которые не планировались к анализу, замена не реализована.
       * ТекстОшибки - Строка - Подробное описание ошибки.</pre>
<p class="Paragraph0c"><span class="Bold">Пример вызова</span></p>
<pre> Результат = ОбщегоНазначения.ЗаменитьСсылки(ПарыЗамен, Параметры)</pre>
<p class="Paragraph0c"><span class="Bold">Доступность</span></p>
<pre> Сервер, Толстый клиент, Внешнее соединение</pre>
	</body>
</html>