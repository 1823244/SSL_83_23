<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>3.51. &#1058;&#1077;&#1082;&#1091;&#1097;&#1080;&#1077; &#1076;&#1077;&#1083;&#1072;</title>
		<LINK REL="stylesheet" href="style.css@_=1504708101">
		<SCRIPT src="script.js@_=1504708101" TYPE="text/javascript"></script>		<!--[if !IE]>--><SCRIPT src="zeroclipboard.js@_=1504708101" TYPE="text/javascript"></script><!--<![endif]-->
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="3.51. _25F2_25E5_25EA_25F3_25F9_25E8_25E5 _25E4_25E5_25EB_25E0.htm" rel="canonical">
<link href="../../../../static/its.content.css@_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="../../../../static/its.content.js@_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="../../../../static/html5shiv.js@_=1500896273"></script><![endif]-->

</head>
	<body class="bspdoc">
<a name="_текущие_дела"></a><h1>3.51. Текущие дела</h1>

<p class="Paragraph0c">Подсистема «Текущие дела» позволяет выводить список дел
пользователя на рабочем столе (новые письма, задачи, заявки, несогласованные
заказы и т. п.). Список дел определяется разработчиком конфигурации при
внедрении подсистемы и может включать в себя важные и обычные дела,
однострочные и многострочные, с количественными показателями и без. Список дел
сгруппирован по разделам командного интерфейса, предусмотрена возможность
настраивать видимость и порядок отображения, автоматическое обновление через
заданный интервал.</p>

<a name="issogl1_настройка"><h2>Настройка</h2></a>

<p class="Paragraph0c">Разместить основную форму обработки <span class="Interface">ТекущиеДела</span>
в правой колонке рабочей области начальной страницы.</p>

<p class="Paragraph0c">Принять решение по поводу состава дел, выводимых на
рабочем столе. Например, это могут быть уведомления о новых письмах, задачах,
заявках, несогласованных заказах и других делах, с которыми сталкиваются
пользователи по своим должностным обязанностям. С каждым делом необходимо
связать форму списка или рабочего места, которое должно открываться по нажатию
на гиперссылку дела.</p>

<p class="Paragraph0c">Рекомендуется группировать дела по разделам командного
интерфейса, в которых размещены команды открытия рабочих мест по разбору этих
дел. Например, если работа с письмами и задачами предусмотрена в разделе <span class="Interface">Органайзер</span>, то соответствующие им дела также следует
размещать в этом разделе панели <span class="Interface">Текущие дела</span>. </p>

<p class="Paragraph0c">При этом с помощью процедуры <span class="Interface">ПриОпределенииПорядкаРазделовКомандногоИнтерфейса</span>
общего модуля <span class="Interface">ТекущиеДелаПереопределяемый</span> можно
указать порядок следования разделов панели, который в точности соответствует
порядку в интерфейсе программы.</p>

<a name="issogl2_добавление_нового_дела"><h3>Добавление нового дела</h3></a>

<p class="Paragraph0c">Для добавления нового дела на панель <span class="Interface">Текущие дела</span> необходимо в процедуре <span class="Interface">ПриОпределенииОбработчиковТекущихДел</span> общего модуля <span class="Interface">ТекущиеДелаПереопределяемый</span> объявить общий модуль или
модуль менеджера объекта, который будет предоставлять сведения об этом деле.
Например:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ПриОпределенииОбработчиковТекущихДел<span class="operator">(</span>Обработчики<span class="operator">)</span> <span class="keyword">Экспорт</span>
    Обработчики<span class="operator">.</span>Добавить<span class="operator">(</span>Документы<span class="operator">.</span>_ДемоЗаказПокупателя<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="Paragraph0c">После этого необходимо в указанном модуле определить
экспортную процедуру <span class="Interface">ПриЗаполненииСпискаТекущихДел</span>
по шаблону:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Заполняет список текущих дел пользователя.</span>
<span class="comment">//</span>
<span class="comment">// Параметры:</span>
<span class="comment">//  ТекущиеДела – ТаблицаЗначений – таблица с колонками:</span>
<span class="comment">//   * Идентификатор           – Строка – внутренний идентификатор дела, используемый механизмом &quot;Текущие дела&quot;.</span>
<span class="comment">//   * ЕстьДела                – Булево – если Истина, дело выводится в списке текущих дел пользователя.</span>
<span class="comment">//   * Важное                  – Булево – если Истина, дело будет выделено красным цветом.</span>
<span class="comment">//   * Представление           – Строка – представление дела, выводимое пользователю.</span>
<span class="comment">//   * Количество              – Число  – количественный показатель дела, выводится в строке заголовка дела.</span>
<span class="comment">//   * Форма                   – Строка – полный путь к форме, которую необходимо открыть при нажатии на гиперссылку</span>
<span class="comment">//                                        дела на панели &quot;Текущие дела&quot;.</span>
<span class="comment">//   * ПараметрыФормы          – Структура – параметры, с которыми нужно открывать форму показателя.</span>
<span class="comment">//   * Владелец                – Строка, объект метаданных – строковый идентификатор дела, которое будет владельцем для текущего</span>
<span class="comment">//                               или объект метаданных подсистема.</span>
<span class="comment">//   * Подсказка               – Строка – текст подсказки.</span>
<span class="comment">//</span>
<span class="keyword">Процедура</span> ПриЗаполненииСпискаТекущихДел<span class="operator">(</span>ТекущиеДела<span class="operator">)</span> <span class="keyword">Экспорт</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="Paragraph0c">И вписать в нее код по добавлению дел в таблицу <span class="Interface">ТекущиеДела</span>.</p>

<p class="Warningword">Важно!</p>

<p class="Notes">При добавлении дела необходимо проверять право <span class="Interface">Редактирование</span> текущего пользователя на объект метаданных,
предоставляющий это дело, а также значения функциональных опций (если они
предусмотрены). </p>

<p class="Paragraph0c">Пример заполнения дела по документам <span class="Interface">_ДемоЗаказПокупателя</span>: </p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ПриЗаполненииСпискаТекущихДел<span class="operator">(</span>ТекущиеДела<span class="operator">)</span> <span class="keyword">Экспорт</span>
    <span class="keyword">Если</span> <span class="keyword">Не</span> ПравоДоступа<span class="operator">(</span><span class="string">&quot;Редактирование&quot;</span><span class="operator">,</span> Метаданные<span class="operator">.</span>Документы<span class="operator">.</span>_ДемоЗаказПокупателя<span class="operator">)</span> <span class="keyword">Тогда</span>
        <span class="keyword">Возврат</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    КоличествоЗаказовПокупателя <span class="operator">=</span> КоличествоЗаказовПокупателя<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    СписокОтбора <span class="operator">=</span> <span class="keyword">Новый</span> СписокЗначений<span class="operator">;</span>
    СписокОтбора<span class="operator">.</span>Добавить<span class="operator">(</span>Перечисления<span class="operator">.</span>_ДемоСтатусыЗаказовПокупателей<span class="operator">.</span>НеСогласован<span class="operator">)</span><span class="operator">;</span>
    СписокОтбора<span class="operator">.</span>Добавить<span class="operator">(</span>Перечисления<span class="operator">.</span>_ДемоСтатусыЗаказовПокупателей<span class="operator">.</span>Согласован<span class="operator">)</span><span class="operator">;</span>
    ИдентификаторЗаказыПокупателя <span class="operator">=</span> <span class="string">&quot;ЗаказыПокупателя&quot;</span><span class="operator">;</span>
    Дело <span class="operator">=</span> ТекущиеДела<span class="operator">.</span>Добавить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Идентификатор  <span class="operator">=</span> ИдентификаторЗаказыПокупателя<span class="operator">;</span>
    Дело<span class="operator">.</span>ЕстьДела       <span class="operator">=</span> КоличествоЗаказовПокупателя<span class="operator">.</span>Всего <span class="operator">&gt;</span> <span class="number">0</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Представление  <span class="operator">=</span> НСтр<span class="operator">(</span><span class="string">&quot;ru = 'Заказы покупателя'&quot;</span><span class="operator">)</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Количество     <span class="operator">=</span> КоличествоЗаказовПокупателя<span class="operator">.</span>Всего<span class="operator">;</span>
    Дело<span class="operator">.</span>Форма          <span class="operator">=</span> <span class="string">&quot;Документ._ДемоЗаказПокупателя.Форма.ФормаСписка&quot;</span><span class="operator">;</span>
    Дело<span class="operator">.</span>ПараметрыФормы <span class="operator">=</span> <span class="keyword">Новый</span> Структура<span class="operator">(</span><span class="string">&quot;Отбор&quot;</span><span class="operator">,</span> <span class="keyword">Новый</span> Структура<span class="operator">(</span><span class="string">&quot;СтатусЗаказа&quot;</span><span class="operator">,</span> СписокОтбора<span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Владелец       <span class="operator">=</span> Метаданные<span class="operator">.</span>Подсистемы<span class="operator">.</span>_ДемоОрганайзер<span class="operator">;</span>
    Дело <span class="operator">=</span> ТекущиеДела<span class="operator">.</span>Добавить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Идентификатор  <span class="operator">=</span> <span class="string">&quot;ЗаказыПокупателяНеСогласовано&quot;</span><span class="operator">;</span>
    Дело<span class="operator">.</span>ЕстьДела       <span class="operator">=</span> КоличествоЗаказовПокупателя<span class="operator">.</span>НеСогласовано <span class="operator">&gt;</span> <span class="number">0</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Важное         <span class="operator">=</span> <span class="keyword">Истина</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Представление  <span class="operator">=</span> НСтр<span class="operator">(</span><span class="string">&quot;ru = 'Не согласовано'&quot;</span><span class="operator">)</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Количество     <span class="operator">=</span> КоличествоЗаказовПокупателя<span class="operator">.</span>НеСогласовано<span class="operator">;</span>
    Дело<span class="operator">.</span>Владелец       <span class="operator">=</span> ИдентификаторЗаказыПокупателя<span class="operator">;</span>
    Дело <span class="operator">=</span> ТекущиеДела<span class="operator">.</span>Добавить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Идентификатор  <span class="operator">=</span> <span class="string">&quot;ЗаказыПокупателяСогласовано&quot;</span><span class="operator">;</span>
    Дело<span class="operator">.</span>ЕстьДела       <span class="operator">=</span> КоличествоЗаказовПокупателя<span class="operator">.</span>Согласовано <span class="operator">&gt;</span> <span class="number">0</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Представление  <span class="operator">=</span> НСтр<span class="operator">(</span><span class="string">&quot;ru = 'Согласовано'&quot;</span><span class="operator">)</span><span class="operator">;</span>
    Дело<span class="operator">.</span>Количество     <span class="operator">=</span> КоличествоЗаказовПокупателя<span class="operator">.</span>Согласовано<span class="operator">;</span>
    Дело<span class="operator">.</span>Владелец       <span class="operator">=</span> ИдентификаторЗаказыПокупателя<span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<a name="issogl2_настройка_прав_доступа_пользователей"><h3>Настройка прав доступа пользователей</h3></a>

<p class="Paragraph0c">Для настройки прав доступа пользователей к функциям
подсистемы «Текущие дела» нужно использовать следующую роль:</p>

<p class="Objectname">Таблица 3.109.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">№</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Роли и их назначение</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="TextinTable81">1.</p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ИспользованиеТекущихДел</span></p>
  <p class="TextinTable81">Предоставляет доступ для работы со списком текущих дел</p>
  </td>
 </tr>
</table>

<a name="issogl1_использование_при_разработке_конфигурации"><h2>Использование при разработке конфигурации</h2></a>

<a name="issogl2_настройка_обмена_данными"><h3>Настройка обмена данными</h3></a>

<p class="Paragraph0c">Для настройки обмена данными никаких действий не
требуется, так как подсистема не предоставляет собственных данных.</p>		<script type="text/javascript">listenCopy('zeroclipboard.swf');</script>
	</body>
</html>