<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>5.30 &#1054;&#1073;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077; &#1082;&#1086;&#1085;&#1092;&#1080;&#1075;&#1091;&#1088;&#1072;&#1094;&#1080;&#1080;</title>
		<LINK REL="stylesheet" href="style.css@_=1504708101">
		<SCRIPT src="script.js@_=1504708101" TYPE="text/javascript"></script>
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="5.30 _25EE_25E1_25ED_25EE_25E2_25EB_25E5_25ED_25E8_25E5 _25EA_25EE_25ED_25F4_25E8_25E3_25F3_25F0_25E0_25F6_25E8_25E8.htm" rel="canonical">
<link href="../../../../static/its.content.css@_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="../../../../static/its.content.js@_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="../../../../static/html5shiv.js@_=1500896273"></script><![endif]-->

</head>
	<body class="bspdoc">
<h1>5.30 Обновление конфигурации</h1>

<p class="Paragraph0c"><a name="_получение_файла_обновления"></a><a name="_установка_обновлений_1"></a><a name="_обновление_конфигурации_через"></a><a name="_установка_обновлений"></a>Программа позволяет обновлять конфигурацию ИБ
в режиме 1С:Предприятия. Обновление производится по требованию или в указанное
время. Обновление программы доступно только пользователю с ролью <span class="Interface">Администратор системы</span>.</p>

<p class="Paragraph0c">Для обновления конфигурации можно воспользова<a name="_hlt263324726"></a>ться помощником, который открывается командой <span class="Interface">Установка обновлений</span> раздела<span class="Note"> <b>Администрирование</b></span><span class="Interface"> – Поддержка и обслуживание – Результаты обновления программы</span>.
Помощник установки обновлений позволяет провести обновление из файла обновления
в локальном или сетевом каталоге (например, с диска 1С:ИТС).</p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2489.png@_=1504708101" WIDTH="800" ALT HEIGHT="482"></p>

<p class="Paragraph0c"><span class="Interface">Внимание!</span> Помощник не следует
использовать, если в программе включена возможность изменения объектов
метаданных. В таких случаях рекомендуется выполнять обновление в режиме <span class="Interface">Конфигуратор</span>. Подробнее об этом читайте в книге «1С:Предприятие
8.3. Руководство разработчика».</p>

<a name="issogl1_обновление_конфигурации_из_произвольного_файла"><h2>Обновление конфигурации из произвольного файла</h2></a>

<p class="Paragraph0c">В случае если файл обновления уже имеется, то помощник позволяет провести обновление с
использованием файла поставки обновления (<span class="Interface">.</span><span class="Interface">cfu</span>) или файла поставки конфигурации (<span class="Interface">.</span><span class="Interface">cf</span>) из локального или сетевого каталога. </p>

<p class="Paragraph0c">Если файл обновления
уже загружен в основную конфигурацию, и она отличается от конфигурации
информационной базы, то необходимо выбрать вариант обновления <span class="Interface">Файл обновления не требуется</span>. Эта возможность может быть
востребована, например, если администратор загрузил файл обновления, но в
программе в тот момент еще работали пользователи, и обновление пришлось
запланировать на другое более подходящее время, например, на ночь.</p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2491.png@_=1504708101" WIDTH="734" ALT HEIGHT="335"></p>

<p class="Paragraph0c">Если файл обновления еще не загружен в конфигурацию, с
помощью переключателя <span class="Interface">Укажите файл обновления</span>, <span class="Note">например,</span>
<span class="Note"><b>F</b></span><span class="Note"><b>:\1</b></span><span class="Note"><b>C</b></span><span class="Note"><b>\</b></span><span class="Note"><b>SSL</b></span><span class="Note"><b>_2.3.3.40_07905.</b></span><span class="Note"><b>cf</b></span>. Для продолжения нажмите кнопку <span class="Interface">Далее</span>.</p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2493.png@_=1504708101" WIDTH="786" ALT HEIGHT="664"></p>

<p class="Paragraph0c">После нажатия кнопки <span class="Interface">Далее</span>
программа предложит провести обновление (после подтверждения легальности
получения файлов обновления). </p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2495.png@_=1504708101" WIDTH="733" ALT HEIGHT="520"></p>

<p class="Paragraph0c">Установка обновления
выполняется от имени текущего пользователя. При необходимости введите <span class="Interface">Параметры администрирования информационной базы – Имя
пользователя и Пароль</span>, если для
доступа к информационной базе необходима авторизация. В случае
клиент-серверного варианта работы программы также может потребоваться ввести
имя и пароль администратора кластера серверов. </p>

<p class="Paragraph0c">Требуется с помощью
переключателя уточнить время обновления конфигурации ИБ:</p>

<p class="Bullet1">&#9632; 
<span class="Interface">Установить обновление
прямо сейчас </span>– для обновления
потребуется перезапустить программу;</p>

<p class="Bullet1">&#9632; 
<span class="Interface">Напомнить при завершении
работы</span>;</p>

<p class="Bullet1">&#9632; 
<span class="Interface">Запланировать установку
обновления на указанное время</span> – в
клиент-серверном варианте работы программы есть возможность указать время и
дату обновления конфигурации. </p>

<p class="Paragraph0c">Перед началом обновления
версии программы рекомендуется создавать резервную копию информационной базы.
Резервная копия используется для автоматического восстановления информационной
базы в случае нештатной ситуации. Подробнее см. раздел документации Резервное
копирование ИБ.</p>

<p class="Paragraph0c"><span class="Paragraph0c0">В
клиент-серверном режиме рекомендуется создать резервную копию средствами СУБД.</span></p>

<p class="Paragraph0c">К настройке
автоматического создания резервной копии в файловом варианте работы можно
перейти по ссылке <span class="Interface">Создавать временную резервную
копию ИБ и выполнять откат при нештатной ситуации</span>. </p>

<p class="Paragraph0c">Для создания резервной копии выберите параметры:</p>

<p class="Bullet1">&#9632; 
<span class="Interface">Не создавать резервную
копию</span><span class="Paragraph0c0">.</span> Если для резервного копирования используются
сторонние средства, то можно отключить автоматическое создание резервной копии.
Создать резервную копию можно и другими средствами, например, путем копирования
файла информационной базы; </p>

<p class="Bullet1">&#9632; 
<span class="Interface">Создать временную
резервную копию</span> (установлено по умолчанию). В этом случае копия
создается во временной папке, т.е. в папке <span class="Interface">Temp</span> и автоматически
будет удалена Windows;</p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2497.png@_=1504708101" WIDTH="581" ALT HEIGHT="351"></p>

<p class="Bullet1">&#9632; 
Включите флажок <span class="Interface">Восстанавливать
информационную базу</span><span class="Paragraph0c0"> (установлен по умолчанию, рекомендуется), </span>для
того чтобы можно было осуществить откат в случае возникновения нештатной
ситуации при обновлении программы;</p>

<p class="Bullet1">&#9632; 
<span class="Interface">Создать резервную копию и
сохранить в указанном каталоге</span>, <span class="Note">например,</span> <span class="Note"><b>C:\Резервное
копирование</b></span>. В этом случае откат к резервной копии при
возникновении нештатной ситуации будет выполнен автоматически.</p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2499.png@_=1504708101" WIDTH="581" ALT HEIGHT="351"></p>

<p class="Paragraph0c">После установки параметров резервного копирования нажмите <span class="Interface">ОК</span> для возврата к установке обновления.</p>

<p class="Paragraph0c">Прежде чем
продолжить обновление конфигурации, необходимо сохранить несохраненные данные
или закрыть окна их редактирования. </p>

<p class="Paragraph0c">В клиент-серверном
варианте работы программы все соединения будут завершены автоматически, а на
время создания резервной копии и обновления конфигурации устанавливается
блокировка соединений. </p>

<p class="Paragraph0c">Для файлового
варианта работы необходимо выполнить следующие действия: </p>

<p class="Bullet1">&#9632; 
Если открыт <span class="Interface">Конфигуратор</span>,
то необходимо его закрыть (программа выводит соответствующее сообщение); </p>

<p class="Bullet1">&#9632; 
Завершить работу пользователей. Для того чтобы
проконтролировать текущие сеансы, перейдите по ссылке <span class="Interface">Посмотреть
список активных пользователей</span>. Подробнее см. раздел документации
Завершение работы пользователей;</p>

<p class="Bullet1">&#9632; 
Если к программе подключены другие программы в
режиме внешнего соединения, то необходимо завершить их работу. </p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2501.png@_=1504708101" WIDTH="800" ALT HEIGHT="520"></p>

<p class="Paragraph0c">Если все указанные
условия выполнены, после нажатия кнопки <span class="Interface">Далее</span> программа автоматически создаст резервную
копию ИБ (если это предусмотрено), и обновит конфигурацию. </p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2503.png@_=1504708101" WIDTH="600" ALT HEIGHT="320"></p>

<p class="Paragraph0c">Процесс обновления
программы может занять продолжительное время, в зависимости от
производительности компьютера и объема информационной базы. Не выключайте
питание компьютера до завершения процесса. </p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2505.png@_=1504708101" WIDTH="600" ALT HEIGHT="320"></p>

<p class="Paragraph0c">После завершения
обновления конфигурации программа будет автоматически запущена и готова к
дальнейшей работе. </p>

<p class="Paragraph0c">Если был выбран
вариант <span class="Interface">Напомнить при завершении работы</span>, то
автоматического запуска программы не происходит.</p>

<p class="Paragraph0c">Для базовых версий
конфигураций после обновления требуется выполнить первый запуск программы от
имени администратора, во время которого будет выполнено завершение процесса
обновления конфигурации. </p>

<p class="Paragraph0c">Помощник выводит
сообщение об успешном завершении обновления программы. Нажмите кнопку <span class="Interface">Готово</span>, для того
чтобы приступить к работе в программе. </p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2507.png@_=1504708101" WIDTH="687" ALT HEIGHT="329"></p>

<p class="Paragraph0c"><a name="_планирование_обновлений"></a>При работе в клиент-серверном варианте работы
программы можно задавать отложенное по времени обновление, например, можно
отложить обновление конфигурации на ночь. </p>

<p class="Paragraph0c">Для этого при
обновлении конфигурации в помощнике выберите с помощью переключателя <span class="Interface">Запланировать установку обновления на указанное время</span> и укажите время и дату обновления. </p>

<p class="Paragraph0c">Существует
возможность настроить отправку отчета на указанный адрес электронной почты об
успешном или неуспешном выполнении обновления. Отправка сообщения производится
с компьютера, на которой установлен сервер 1С:Предприятие. Для этого включите
флажок <span class="Interface">Выслать отчет на почту</span>, напишите адрес электронной почты.</p>

<p class="Paragraph0c">Запланированное
обновление будет выполнено с клиентского компьютера в фоновом режиме. Питание
компьютера должно быть включено в указанную дату и время.</p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2509.png@_=1504708101" WIDTH="733" ALT HEIGHT="439"></p>

<p class="Paragraph0c">Для получения
технической информации о причинах проблем с установкой обновлений можно
воспользоваться следующими средствами: </p>

<p class="Bullet1">&#9632; 
Записи о произведенных операциях и возникших
ошибках в ходе обновления заносятся в <span class="Interface">Журнал регистрации</span>
(тип события <span class="Interface">Обновление информационной базы</span>).
Воспользуйтесь ссылкой <span class="Interface">Журнал регистрации</span>, для
того чтобы просмотреть технические подробности;</p>

<p class="Picture"><IMG src="_img/6a86e8eeb8675758b0754db5426adc35/image2511.png@_=1504708101" WIDTH="734" ALT HEIGHT="359"></p>

<p class="Bullet1">&#9632; 
В процессе установки обновления во временной
папке текущего пользователя Windows
создается лог-файл с записями о ходе обновления (содержимое лог-файла
впоследствии автоматически добавляется в <span class="Interface">Журнал
регистрации</span>). Последний из каталогов вида <span class="Interface">%</span><span class="Interface">temp%\1CUpdate.&lt;набор
цифр&gt;</span>, отсортированных по алфавиту, соответствует последней сессии
обновления; </p>

<p class="Bullet1">&#9632;  Если
настройка операционной системы <span class="Interface">Язык программ, не
поддерживающих Юникод</span> задана некорректно, то процесс обновления
завершится с ошибкой <span class="Interface">invalid </span><span class="Interface">procedure </span><span class="Interface">call </span><span class="Interface">or </span><span class="Interface">arguments</span>,
при этом лог-файл окажется пустым. Для устранения данной ошибки необходимо,
чтобы в региональных настройках операционной системы (<span class="Interface">Панель
управления - Язык и региональные стандарты – Дополнительно</span>) в поле <span class="Interface">Язык программ, не поддерживающих Юникод</span> был выбран
русский язык;</p>

<p class="Bullet1">&#9632; 
Результат обновления информационной базы
записывается в Журнал событий Windows
(<span class="Interface">Event Log</span>).</p>

<p class="Paragraph0c">Если в результате
нештатной ситуации при обновлении база оказалась заблокированной, то ее можно
разблокировать с помощью консоли <span class="Interface">Администрирование
серверов 1С:Предприятия</span>, либо из
командной строки, запустив 1С:Предприятие от имени администратора с ключом <span class="Interface">РазрешитьРаботуПользователей</span> и указав код разблокировки <span class="Interface">ПакетноеОбновлениеКонфигурацииИБ</span>. <span class="Note">Например:</span></p>

<p class="Paragraph0c">&quot;<span class="Note"><b>C:\Program
Files\1cv82\bin\1cv8.exe&quot; ENTERPRISE /S&quot;server\base&quot;
/N&quot;Администратор&quot; /P&quot;&quot; /WA- /CРазрешитьРаботуПользователей
/UCПакетноеОбновлениеКонфигурацииИБ</b></span></p>

<p class="Paragraph0c">Если обновление
конфигурации завершилось неудачей, а во временном log-файле имеется запись: <span class="Interface">Исключение в </span><span class="Interface">createConnection: Error, Automation server
can't create object</span>, то,
скорее всего, используется 32-разрядная компонента <span class="Interface">comcntr.dll</span> на
компьютере под управлением 64-разрядной операционной системы. Для устранения
данной проблемы необходимо взять 64-разрядную компоненту <span class="Interface">comcntr.dll</span> из
поставки 1С:Предприятие x64 Сервер и зарегистрировать ее, запустив из командной
строки:</p>

<p class="Paragraph0c"><span class="Interface">regsvr32 &lt;каталог 64-разрядного
comcntr.dll&gt;\comcntr.dll</span></p>

<p class="Paragraph0c">Выяснив причины
ошибки, произведите соответствующие настройки компьютера, затем нажмите <span class="Interface">Далее</span> для
повторения попытки.</p>

<a name="issogl1_роли_для_работы_с_помощником_установки_обновлений"><h2>Роли для работы с помощником установки обновлений</h2></a>

<p class="Paragraph0c">В состав программы входят следующие роли, необходимые для
обновления конфигурации с использованием помощника:</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="TextinTable81">Роль</p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Краткое описание</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">Администратор системы</span></p>
  </td>
  <td valign="top">
  <p class="TextinTable81">Дает право выполнять
  обновление конфигурации ИБ.</p>
  </td>
 </tr>
</table>
	</body>
</html>