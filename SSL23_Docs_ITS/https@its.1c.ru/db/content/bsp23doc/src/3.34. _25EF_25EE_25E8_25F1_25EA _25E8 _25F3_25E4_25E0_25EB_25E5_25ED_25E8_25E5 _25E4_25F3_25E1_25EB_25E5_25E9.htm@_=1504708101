<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>3.34. &#1055;&#1086;&#1080;&#1089;&#1082; &#1080; &#1091;&#1076;&#1072;&#1083;&#1077;&#1085;&#1080;&#1077; &#1076;&#1091;&#1073;&#1083;&#1077;&#1081;</title>
		<LINK REL="stylesheet" href="style.css@_=1504708101">
		<SCRIPT src="script.js@_=1504708101" TYPE="text/javascript"></script>		<!--[if !IE]>--><SCRIPT src="zeroclipboard.js@_=1504708101" TYPE="text/javascript"></script><!--<![endif]-->
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="3.34. _25EF_25EE_25E8_25F1_25EA _25E8 _25F3_25E4_25E0_25EB_25E5_25ED_25E8_25E5 _25E4_25F3_25E1_25EB_25E5_25E9.htm" rel="canonical">
<link href="../../../../static/its.content.css@_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="../../../../static/its.content.js@_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="../../../../static/html5shiv.js@_=1500896273"></script><![endif]-->

</head>
	<body class="bspdoc">
<a name="_поиск_и_удаление"></a><h1>3.34. Поиск и удаление дублей</h1>

<p class="Paragraph0c">Подсистема «Поиск и удаление дублей» позволяет искать и
удалять дубли элементов (справочников и т. п.), заменяя во всех местах
использования дублирующие элементы выбранным.</p>

<a name="issogl1_настройка"><h2>Настройка</h2></a>

<p class="Paragraph0c">В случае если в конфигурации не используется подсистема
«Настройки программы», то в рабочем месте администратора программы необходимо
разместить обработку <span class="Interface">ПоискИУдалениеДублей</span>. См.
пример в форме <span class="Interface">Органайзер</span> обработки <span class="Interface">ПанельАдминистрированияБСП</span>.</p>

<a name="issogl2_объединение_дублей_и_поиск_мест_использования_элементов_списков"><h3>Объединение дублей и поиск мест использования элементов списков</h3></a>

<p class="Paragraph0c">Принять решение по поводу состава объектов конфигурации, в
списках которых востребована возможность объединения дублей и мест
использования выбранных элементов. Это могут быть справочники, планы видов
характеристик, планы счетов и планы видов расчета, в которых вследствие ручного
ввода или синхронизации данных с другими программами часто возникают дубли и
необходимо их оперативное устранение.</p>

<p class="Paragraph0c">В формах списков этих объектов необходимо добавить две
команды:</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ОбъединитьВыделенные</span>,
синоним «Объединить выделенные...»;</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">ПоказатьМестаИспользования</span>,
синоним «Места использования».</p>

<p class="Paragraph0c">Затем определить для них обработчики:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// СтандартныеПодсистемы.ПоискИУдалениеДублей</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ОбъединитьВыделенные<span class="operator">(</span>Команда<span class="operator">)</span>
    ПоискИУдалениеДублейКлиент<span class="operator">.</span>ОбъединитьВыделенные<span class="operator">(</span>Элементы<span class="operator">.</span>Список<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ПоказатьМестаИспользования<span class="operator">(</span>Команда<span class="operator">)</span>
    ПоискИУдалениеДублейКлиент<span class="operator">.</span>ПоказатьМестаИспользования<span class="operator">(</span>Элементы<span class="operator">.</span>Список<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="comment">// Конец СтандартныеПодсистемы.ПоискИУдалениеДублей</span></pre>

<p class="Paragraph0c">Рекомендуется размещать указанные команды в подменю <span class="Interface">Еще</span> (<span class="Interface">Все действия</span>) и в
контекстном меню списка. Пример внедрения см. в справочнике <span class="Interface">_ДемоФизическиеЛица</span>.</p>

<a name="issogl2_ограничения_замены_ссылок_поиска_и_удаления_дублей"><h3>Ограничения замены ссылок, поиска и удаления дублей</h3></a>

<p class="Paragraph0c">При использовании обработки <span class="Interface">ЗаменаСсылок</span>
и процедуры <span class="Interface">ЗаменитьСсылки</span> общего модуля <span class="Interface">ОбщегоНазначения</span> существует возможность контроля
допустимости замены одной ссылки на другую. Для этого необходимо добавить в
модуль менеджера контролируемого объекта (справочника, плана видов характеристик
и т. п.) функцию <span class="Interface">ВозможностьЗаменыЭлементов</span>. В ней
реализовать алгоритм, который с прикладной точки зрения анализирует
предлагаемые замены и возвращает описание ошибки о недопустимости замены одной
ссылки на другую.</p>

<p class="Paragraph0c">Также предусмотрена возможность реализовать собственную
логику поиска дублей при вызове функции <span class="Interface">НайтиДублиЭлемента</span>
общего модуля <span class="Interface">ПоискИУдалениеДублей</span> и при
использовании обработки <span class="Interface">ПоискИУдалениеДублей</span>. Для
этого необходимо определить в модуле менеджера интересующего нас объекта две
процедуры:</p>

<p class="MsoListBullet">&#9679; 
процедуру <span class="Interface">ПараметрыПоискаДублей</span>,
в которой можно переопределить параметры поиска дублей, заданные пользователем
или при программном поиске;</p>

<p class="MsoListBullet">&#9679; 
процедуру <span class="Interface">ПриПоискеДублей</span>,
в которой реализовать собственную логику определения дублей.</p>

<p class="Paragraph0c">Пример реализации, описания и использования этих функций
можно найти в модуле менеджера справочника <span class="Interface">_ДемоНоменклатура</span>.
Пример использования программного интерфейса – в обработчике записи модуля
формы этого же справочника.</p>

<a name="issogl2_настройка_прав_доступа_пользователей"><h3>Настройка прав доступа пользователей</h3></a>

<p class="Paragraph0c">Для настройки прав доступа пользователей к данным
подсистемы нужно использовать следующие роли: </p>

<p class="Objectname">Таблица 3.73.</p>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">№</span></p>
   </td>
   <td valign="top">
   <p class="TextinTable81"><span class="Interface">Роли и их назначение</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="TextinTable81">1.   </p>
  </td>
  <td valign="top">
  <p class="TextinTable81"><span class="Interface">ПолныеПрава</span> (из подсистемы «Базовая
  функциональность»)</p>
  <p class="TextinTable81">Удаление дублей элементов с заменой во всех местах использования дублирующих
  элементов выбранным</p>
  </td>
 </tr>
</table>

<a name="issogl1_использование_при_разработке_конфигурации"><h2>Использование при разработке конфигурации</h2></a>

<a name="issogl2_контроль_замены_ссылок_при_записи_объектов_и_выполнение_связанных_действий"><h3>Контроль замены ссылок при записи объектов и выполнение связанных действий</h3></a>

<p class="Paragraph0c">При замене ссылок в документах документы записываются без
перепроведения, чтобы не нарушать последовательности. Как следствие, не
срабатывает событие <span class="Interface">ОбработкаПроведения</span> и вся
прикладная логика проведения по регистрам. Подробнее  см. раздел «<A href="3.4. _25E1_25E0_25E7_25EE_25E2_25E0_25FF _25F4_25F3_25ED_25EA_25F6_25E8_25EE_25ED_25E0_25EB_25FC_25ED_25EE_25F1_25F2_25FC.htm@_=1504708101#_контроль_замены_ссылок">Контроль замены ссылок при записи объектов и
выполнение связанных действий</a>».</p>

<a name="issogl2_настройка_обмена_данными"><h3>Настройка обмена данными</h3></a>

<p class="Paragraph0c">Для настройки обмена данными никаких действий не
требуется, так как подсистема не предоставляет собственных данных.</p>		<script type="text/javascript">listenCopy('zeroclipboard.swf');</script>
	</body>
</html>